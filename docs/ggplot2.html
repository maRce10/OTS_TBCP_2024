<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-09-16">

<title>OTS TBCP 2024 - Elegant graphs with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">OTS TBCP 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="./r_basics.html">
 <span class="dropdown-text">R basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./importing_data.html">
 <span class="dropdown-text">Import and format data in R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simulate_data.html">
 <span class="dropdown-text">Simulating data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./linear_regression.html">
 <span class="dropdown-text">Regression models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ggplot2.html">
 <span class="dropdown-text">Elegant graphs with ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./course_prep.html"> 
<span class="menu-text">Course prep</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://codefile.io/f/inMsojTFoN"> 
<span class="menu-text">Sharing code</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html"> 
<span class="menu-text">Instructor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maRce10/OTS_TBCP_2024"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#grammar-of-graphics" id="toc-grammar-of-graphics" class="nav-link active" data-scroll-target="#grammar-of-graphics"><span class="header-section-number">1</span> Grammar of graphics</a></li>
  <li><a href="#graph-components" id="toc-graph-components" class="nav-link" data-scroll-target="#graph-components"><span class="header-section-number">2</span> Graph components</a></li>
  <li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots"><span class="header-section-number">3</span> Scatter plots</a>
  <ul class="collapse">
  <li><a href="#aesthetic-attributes" id="toc-aesthetic-attributes" class="nav-link" data-scroll-target="#aesthetic-attributes"><span class="header-section-number">3.1</span> Aesthetic attributes</a></li>
  <li><a href="#multipanel-plots-facetting" id="toc-multipanel-plots-facetting" class="nav-link" data-scroll-target="#multipanel-plots-facetting"><span class="header-section-number">3.2</span> Multipanel plots (Facetting)</a></li>
  <li><a href="#additional-geoms" id="toc-additional-geoms" class="nav-link" data-scroll-target="#additional-geoms"><span class="header-section-number">3.3</span> Additional “geoms”</a></li>
  <li><a href="#customizing-ggplots" id="toc-customizing-ggplots" class="nav-link" data-scroll-target="#customizing-ggplots"><span class="header-section-number">3.4</span> Customizing ggplots</a></li>
  <li><a href="#other-r-graphing-packages" id="toc-other-r-graphing-packages" class="nav-link" data-scroll-target="#other-r-graphing-packages"><span class="header-section-number">3.5</span> Other R graphing packages</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">3.6</span> References</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><font size="7"><b>Elegant graphs with ggplot2</b></font></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="objectives" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Objectives</h1>
<ul>
<li>Understand the logic used by ggplot2 to structure graphs</li>
<li>Get familiar with its basic functions and types layer</li>
</ul>
</section>
<section id="ggplot2" class="level1 unnumbered unlisted alert alert-warning">
<h1 class="unnumbered unlisted">ggplot2</h1>
<ul>
<li><p>An R package specifically designed to produce graphics</p></li>
<li><p>Unlike other packages, ggplot2 has its own grammar</p></li>
<li><p>The grammar is based on “Grammar of Graphics” (Wilkinson 2005)</p></li>
<li><p>Independent modules that can be combined in many forms</p></li>
<li><p>This grammar provides high flexibility</p></li>
</ul>
</section>
<p>&nbsp;</p>
<section id="grammar-of-graphics" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Grammar of graphics</h1>
<p>The main idea is to start with a base layer of raw data and then add more layers of annotations and statistical summaries. The package allows us to produce graphics using the same structure of thought that we use when designing an analysis, reducing the distance of how we visualize a graphic in the head and the final product.</p>
<p>Learning the grammar will not only be crucial to produce a graph of interest, but also to think about other more complex graphs. The advantage of this grammar is the possibility to create new graphs composed of new combinations of elements.</p>
<p>&nbsp;</p>
</section>
<section id="graph-components" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Graph components</h1>
<p>All ggplot2 graphs contain the following components:</p>
<ul>
<li><strong>Data</strong> - The R object with the information that needs to be plotted</li>
<li><strong>layers</strong> - The specific data that will be plotted (e.g.&nbsp;‘x’ &amp; ‘y’)</li>
<li><strong>scale</strong> - The range of the data to be included</li>
<li><strong>coord.</strong> - Coordinate system (not used very often)</li>
<li><strong>facet</strong> - determines how to break the data in subplots in a multipanel</li>
<li><strong>theme</strong> - controls the plot style &nbsp;</li>
</ul>
<p>This components are put together using “+”.</p>
<p>The most common syntax includes the data within the “ggplot” call and a “geom_” layer.</p>
<p>&nbsp;</p>
<p>First install/load the package:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># load library</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
</section>
<section id="scatter-plots" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Scatter plots</h1>
<p>Let’s use the “iris” data set to create scatter plots:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>This plot is defined by 3 components: 1. “data”- iris 1. “aes” - Sepal.length vs Petal.length 1. “layer” - Points (geom)</p>
<p>&nbsp;</p>
<section id="aesthetic-attributes" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="aesthetic-attributes"><span class="header-section-number">3.1</span> Aesthetic attributes</h2>
<p>We can also add other aesthetic attributes like color, shape and size. This attributes can be included within <code>aes()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># color by species</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># color and shape by species</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Note that the aesthetic arguments can also be included in the “geom” layer:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>We can also include a fixed value:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Some attributes work better with some data types:</p>
<ul>
<li>Color and shape: categorical variables</li>
<li>Size: continuous variables</li>
</ul>
<p>&nbsp;</p>
<p><br></p>
<div class="alert alert-info">
<p><font size="5">Exercise 1</font></p>
<p>Using the “hylaeformis” data set (<a href="https://raw.githubusercontent.com/maRce10/OTS_Tropical_Biology_2023/master/data/hylaeformis_data.csv">it can also be downloaded here</a>):</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read from website</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>hylaeformis_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/maRce10/OTS_Tropical_Biology_2023/master/data/hylaeformis_data.csv"</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># if download manually read it from the local file</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># hylaeformis_data &lt;- read.csv('hylaeformis_data.csv',</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># stringsAsFactors = FALSE)</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hylaeformis_data, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br></p>
<p>1.1 Create a scatter plot of “duration” vs “meanfreq” (mean frequency)</p>
<p>1.2 Add a aesthetic attribute to show a different color for each locality</p>
<p>1.3 Add another aesthetic attribute to show “dfrange” (dominant frequency range) as the shape size</p>
</div>
<p>&nbsp;</p>
</section>
<section id="multipanel-plots-facetting" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="multipanel-plots-facetting"><span class="header-section-number">3.2</span> Multipanel plots (Facetting)</h2>
<ul>
<li>Another way to visualize categorical variables</li>
<li>Allows to create multipanel plots for each level of the variable</li>
<li>2 types: “grid” &amp; “wrap”</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_grid</span>(<span class="sc">~</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>The scale can be fixed or free for the x and y axis, and the number of columns and rows can be modified:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># free x</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free_x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># free x and 3 rows</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># both free and 2 rows</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Note that we can also saved the basic component as an <strong>R</strong> object and add other components later in the code:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="additional-geoms" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="additional-geoms"><span class="header-section-number">3.3</span> Additional “geoms”</h2>
<ul>
<li><code>geom_smooth()</code> - adds best fit lines (including CI)</li>
<li><code>geom_boxplot()</code></li>
<li><code>geom_histogram()</code> &amp; <code>geom_freqpoly()</code> - frequency distributions</li>
<li><code>geom_bar()</code> - frequency distribution of categorical variables</li>
<li><code>geom_path()</code> &amp; <code>geom_line()</code> - add lines to scatter plots</li>
</ul>
<p>&nbsp;</p>
<section id="geom_smooth" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="geom_smooth"><span class="header-section-number">3.3.1</span> geom_smooth()</h3>
<p>Best fit regression lines can be added with <code>geom_smooth()</code>:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># smoother and CI</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># without CI</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise 2</font></p>
<p>Using the “msleep” example data set:</p>
<p><br></p>
<p>2.1 Create a scatter plot of “bodywt”(body weight) vs “brainwt” (brain weight)</p>
<p><br></p>
<p>2.2 Add “order” as a color aesthetic</p>
<p><br></p>
<p>2.3 Add a “facet” component to split plots by order using free scales</p>
<p><br></p>
<p>2.4 Remove the orders with less than 4 species in the data set and make a plot similar to 2.3</p>
<p><br></p>
<p>2.5 Add a smooth line to each plot in the panel</p>
<p><br></p>
</div>
</section>
<section id="boxplots" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="boxplots"><span class="header-section-number">3.3.2</span> Boxplots</h3>
<p>Again, it only takes a new “geom” component to create a boxplot:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An interesting alternative are the violin plots:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="histograms" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="histograms"><span class="header-section-number">3.3.3</span> Histograms</h3>
<p>Same thing with histrograms and frequency plots:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_histogram</span>() <span class="sc">+</span> <span class="fu">geom_freqpoly</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>We can control the width of the bars:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"red2"</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha.f =</span> <span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Duplicated aesthetics after name standardisation: fill</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>And compare the distribution of different groups within the same histogram:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="bar-plots" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="bar-plots"><span class="header-section-number">3.3.4</span> Bar plots</h3>
<p>Show the distribution of discrete (categorical) variables:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(msleep<span class="sc">$</span>order)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(msleep<span class="sc">$</span>order[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>]]))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="customizing-ggplots" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="customizing-ggplots"><span class="header-section-number">3.4</span> Customizing ggplots</h2>
<p>Besides the basic functions (e.g.&nbsp;components) described above, ggplot has many other tools (both arguments and additional functions) to further customize plots. Pretty much every thing can be modified. Here we see some of the most common tools.</p>
<p>&nbsp;</p>
<section id="themes" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="themes"><span class="header-section-number">3.4.1</span> Themes</h3>
<p>ggplot2 comes with some default themes that can be easily applied to modified the look of our plots:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Most themes differ in the use of grids, border lines and axis labeling patterns.</p>
<p>&nbsp;</p>
</section>
<section id="axis-customization" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="axis-customization"><span class="header-section-number">3.4.2</span> Axis customization</h3>
<p>Axis limits can be modified as follows:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-30-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Axis can also be transformed:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log"</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>or reversed:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reverse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="saving-ggplots" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="saving-ggplots"><span class="header-section-number">3.4.3</span> Saving ggplots</h3>
<p>ggplots can be exported as image files using the <code>ggsave</code> function:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> msleep[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">5</span>], ], <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bodywt,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> brainwt)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>order, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"plot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 21 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>The image file type will be identify by the extension in the file name</p>
<p>&nbsp;</p>
<p>Additional axis customizing:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log2 scaling of the y axis (with visually-equal spacing)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(scales)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="fu">log2_trans</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show exponents</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="fu">log2_trans</span>(), <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log2"</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">^</span>x), <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log2"</span>, <span class="fu">math_format</span>(<span class="dv">2</span><span class="sc">^</span>.x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dollar</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scientific</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Agregar 'tick marks' </span><span class="al">###</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librerías</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Animals)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># x and y axis are transformed and formatted</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Animals, <span class="fu">aes</span>(<span class="at">x =</span> body, <span class="at">y =</span> brain)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x), <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># log-log plot without log tick marks</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show log tick marks</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Log ticks on left and right</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"lr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All sides</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"trbl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-34-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="other-graphs" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="other-graphs"><span class="header-section-number">3.4.4</span> Other graphs</h3>
<p>Many other types of graphs can be generated. Here I show a single example of cool contour and “heatmap” graphs:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(faithful)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">eruptions</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">waiting</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">3.60</td>
<td style="text-align: center;">79</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.80</td>
<td style="text-align: center;">54</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3.33</td>
<td style="text-align: center;">74</td>
</tr>
<tr class="even">
<td style="text-align: center;">2.28</td>
<td style="text-align: center;">62</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4.53</td>
<td style="text-align: center;">85</td>
</tr>
<tr class="even">
<td style="text-align: center;">2.88</td>
<td style="text-align: center;">55</td>
</tr>
</tbody>
</table>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span> <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> density,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> ..level..))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..level..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(level)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>&nbsp;</p>
</section>
</section>
<section id="other-r-graphing-packages" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="other-r-graphing-packages"><span class="header-section-number">3.5</span> Other R graphing packages</h2>
<ul>
<li><strong>ggvis</strong> (interactive ggplots)</li>
<li><strong>vcd</strong> (Warnes 2015)</li>
<li><strong>plotrix</strong> (Lemon et al.&nbsp;2006)</li>
<li><strong>gplots</strong> (Warnes 2015)</li>
</ul>
<p>Check the <a href="http://cran.r-project.org/web/views/Graphics.html">CRAN Graphics Task View</a> for a more comprehensive list of graphical tools in <strong>R</strong>.</p>
<hr>
<p>&nbsp;</p>
</section>
<section id="references" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="references"><span class="header-section-number">3.6</span> References</h2>
<ul>
<li>Lemon J (2006) Plotrix: a package in the red light district of R. R-News 6(4):8–12</li>
<li>Warnes GR, Bolker B, Bonebakker L, Gentleman R, Liaw WHA, Lumley T, Maechler M, Magnusson A, Moeller S, Schwartz M, Venables B (2015) gplots: various R programming tools for plotting data. R package version 2.17.0. https://CRAN.R-project.org/package=gplots</li>
<li>Wickham H (2010) A layered grammar of graphics. J Comput Graph Stat 19(1):3–28</li>
<li>Wilkinson L (2005) The grammar of graphics. Statistics and computing, 2nd edn. Springer, New York</li>
</ul>
<hr>
<p><font size="4">Session information</font></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: America/Costa_Rica
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] scales_1.3.0       viridis_0.6.5      viridisLite_0.4.2  MASS_7.3-55       
[5] RColorBrewer_1.1-3 ggplot2_3.5.1      knitr_1.48         kableExtra_1.4.0  

loaded via a namespace (and not attached):
 [1] utf8_1.2.4        generics_0.1.3    xml2_1.3.6        stringi_1.8.4    
 [5] lattice_0.20-45   digest_0.6.37     magrittr_2.0.3    evaluate_0.24.0  
 [9] grid_4.3.2        fastmap_1.2.0     jsonlite_1.8.8    Matrix_1.6-5     
[13] formatR_1.14      gridExtra_2.3     mgcv_1.8-39       fansi_1.0.6      
[17] isoband_0.2.7     textshaping_0.3.7 cli_3.6.3         rlang_1.1.4      
[21] munsell_0.5.1     splines_4.3.2     withr_3.0.1       yaml_2.3.10      
[25] tools_4.3.2       dplyr_1.1.4       colorspace_2.1-1  vctrs_0.6.5      
[29] R6_2.5.1          lifecycle_1.0.4   stringr_1.5.1     htmlwidgets_1.6.4
[33] ragg_1.2.7        pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.5     
[37] glue_1.7.0        systemfonts_1.1.0 xfun_0.47         tibble_3.2.1     
[41] tidyselect_1.2.1  highr_0.11        rstudioapi_0.16.0 farver_2.1.2     
[45] htmltools_0.5.8.1 nlme_3.1-155      rmarkdown_2.28    svglite_2.1.3    
[49] labeling_0.4.3    compiler_4.3.2   </code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/marce10\.github\.io\/OTS_TBCP_2024\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb50" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> &lt;font size="7"&gt;&lt;b&gt;Elegant graphs with ggplot2&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE, message=FALSE}</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- c("kableExtra", "knitr", "ggplot2", "RColorBrewer", "knitr", "MASS", "viridis")</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="in">aa &lt;- lapply(x, function(y) {</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="in">  if(!y %in% installed.packages()[,"Package"])  {if(!y %in% c("warbleR", "Rraven")) install.packages(y) else devtools::install_github(paste0("maRce10/", y))</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="in">try(require(y, character.only = T), silent = T)</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="in">options("digits" = 3, "digits.secs" = 4, knitr.table.format = "html", results = 'asis') </span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="in">tibble &lt;- function(x, ...) { </span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- kbl(x, digits=4, align= 'c', row.names = FALSE) </span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="in">   x &lt;- kable_styling(x, position ="center", full_width = FALSE,  bootstrap_options = c("striped", "hover", "condensed", "responsive")) </span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="in">   asis_output(x)</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="in">registerS3method("knit_print", "data.frame", tibble)</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="in"># ggplot settings</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="in">geom_histogram &lt;- function(...) ggplot2::geom_histogram(..., fill = viridis(10, alpha = 0.5)[8], show.legend = FALSE, bins = 20, color = "black")</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="in">geom_smooth &lt;- function(...) ggplot2::geom_smooth(..., color = viridis(10,  alpha = 0.5)[8])</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a><span class="in">geom_boxplot &lt;- function(...) ggplot2::geom_boxplot(..., fill = viridis(10, alpha = 0.5)[7])</span></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_classic(base_size = 20))</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include = FALSE}</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy.opts = list(width.cutoff = 65), </span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy = TRUE,</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a><span class="in">  message = FALSE</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r functions and data, eval=T, echo=F}</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a><span class="in"># </span></span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a><span class="in"># hylaeformis_data &lt;- read.csv("https://raw.githubusercontent.com/maRce10/OTS_TB_2022/master/data/hylaeformis_data.csv", stringsAsFactors = FALSE)</span></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a><span class="in">hylaeformis_data &lt;- read.csv("./data/hylaeformis_data.csv", stringsAsFactors = FALSE)</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a><span class="fu"># Objectives {.unnumbered .unlisted}</span></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Understand the logic used by ggplot2 to structure graphs</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Get familiar with its basic functions and types layer</span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a><span class="fu"># ggplot2 {.unnumbered .unlisted}</span></span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>An R package specifically designed to produce graphics</span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Unlike other packages, ggplot2 has its own grammar</span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>The grammar is based on "Grammar of Graphics" (Wilkinson 2005)</span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Independent modules that can be combined in many forms</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>This grammar provides high flexibility</span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a><span class="fu"># Grammar of graphics</span></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a>The main idea is to start with a base layer of raw data and then add more layers of annotations and statistical summaries. The package allows us to produce graphics using the same structure of thought that we use when designing an analysis, reducing the distance of how we visualize a graphic in the head and the final product.</span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a>Learning the grammar will not only be crucial to produce a graph of interest, but also to think about other more complex graphs. The advantage of this grammar is the possibility  to create  new graphs composed of new combinations of elements.</span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a><span class="fu"># Graph components</span></span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a>All ggplot2 graphs contain the following components:</span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Data** - The R object with the information that needs to be plotted</span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**layers** - The specific data that will be plotted (e.g. 'x' &amp; 'y')</span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**scale** - The range of the data to be included</span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**coord.** - Coordinate system (not used very often)</span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**facet** - determines how to break the data in subplots in a multipanel</span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**theme** - controls the plot style </span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a>This components are put together using "+".</span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a>The most common syntax includes the data within the "ggplot" call and a "geom_" layer.</span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a>First install/load the package:</span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a><span class="in">#install</span></span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a><span class="in">install.packages("ggplot2") </span></span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a><span class="in"># load library</span></span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2) </span></span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a><span class="fu"># Scatter plots</span></span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a>Let's use the "iris" data set to create scatter plots:</span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-127"><a href="#cb50-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-128"><a href="#cb50-128" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb50-129"><a href="#cb50-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-130"><a href="#cb50-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-131"><a href="#cb50-131" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-132"><a href="#cb50-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-133"><a href="#cb50-133" aria-hidden="true" tabindex="-1"></a>This plot is defined by 3 components:</span>
<span id="cb50-134"><a href="#cb50-134" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>"data"- iris</span>
<span id="cb50-135"><a href="#cb50-135" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>"aes" - Sepal.length vs Petal.length</span>
<span id="cb50-136"><a href="#cb50-136" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>"layer" - Points (geom)</span>
<span id="cb50-137"><a href="#cb50-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-138"><a href="#cb50-138" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-139"><a href="#cb50-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-140"><a href="#cb50-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aesthetic attributes</span></span>
<span id="cb50-141"><a href="#cb50-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-142"><a href="#cb50-142" aria-hidden="true" tabindex="-1"></a>We can also add other aesthetic attributes like color, shape and size. This attributes can be included within <span class="in">`aes()`</span>:</span>
<span id="cb50-143"><a href="#cb50-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-146"><a href="#cb50-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-147"><a href="#cb50-147" aria-hidden="true" tabindex="-1"></a><span class="co"># color by species</span></span>
<span id="cb50-148"><a href="#cb50-148" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length, <span class="at">color =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb50-149"><a href="#cb50-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-150"><a href="#cb50-150" aria-hidden="true" tabindex="-1"></a><span class="co"># color and shape by species</span></span>
<span id="cb50-151"><a href="#cb50-151" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length, <span class="at">color =</span> Species, <span class="at">shape =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb50-152"><a href="#cb50-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-153"><a href="#cb50-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-154"><a href="#cb50-154" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-155"><a href="#cb50-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-156"><a href="#cb50-156" aria-hidden="true" tabindex="-1"></a>Note that the aesthetic arguments can also be included in the "geom" layer:</span>
<span id="cb50-157"><a href="#cb50-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-160"><a href="#cb50-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-161"><a href="#cb50-161" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">shape =</span> Species))</span>
<span id="cb50-162"><a href="#cb50-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-163"><a href="#cb50-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-164"><a href="#cb50-164" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-165"><a href="#cb50-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-166"><a href="#cb50-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-167"><a href="#cb50-167" aria-hidden="true" tabindex="-1"></a>We can also include a fixed value:</span>
<span id="cb50-168"><a href="#cb50-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-171"><a href="#cb50-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-172"><a href="#cb50-172" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Petal.Length)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"red2"</span>)</span>
<span id="cb50-173"><a href="#cb50-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-174"><a href="#cb50-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-175"><a href="#cb50-175" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-176"><a href="#cb50-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-177"><a href="#cb50-177" aria-hidden="true" tabindex="-1"></a>Some attributes work better with some data types:</span>
<span id="cb50-178"><a href="#cb50-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-179"><a href="#cb50-179" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Color and shape: categorical variables</span>
<span id="cb50-180"><a href="#cb50-180" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Size: continuous variables</span>
<span id="cb50-181"><a href="#cb50-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-182"><a href="#cb50-182" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-183"><a href="#cb50-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-184"><a href="#cb50-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-185"><a href="#cb50-185" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-186"><a href="#cb50-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-187"><a href="#cb50-187" aria-hidden="true" tabindex="-1"></a>&lt;div class="alert alert-info"&gt;</span>
<span id="cb50-188"><a href="#cb50-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-189"><a href="#cb50-189" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Exercise 1&lt;/font&gt; </span>
<span id="cb50-190"><a href="#cb50-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-191"><a href="#cb50-191" aria-hidden="true" tabindex="-1"></a>Using the "hylaeformis" data set (<span class="co">[</span><span class="ot">it can also be downloaded here</span><span class="co">](https://raw.githubusercontent.com/maRce10/OTS_Tropical_Biology_2023/master/data/hylaeformis_data.csv)</span>):</span>
<span id="cb50-192"><a href="#cb50-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-193"><a href="#cb50-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,  eval=F, echo=T}</span></span>
<span id="cb50-194"><a href="#cb50-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-195"><a href="#cb50-195" aria-hidden="true" tabindex="-1"></a><span class="in">#read from website</span></span>
<span id="cb50-196"><a href="#cb50-196" aria-hidden="true" tabindex="-1"></a><span class="in">hylaeformis_data &lt;- read.csv("https://raw.githubusercontent.com/maRce10/OTS_Tropical_Biology_2023/master/data/hylaeformis_data.csv", stringsAsFactors = FALSE)</span></span>
<span id="cb50-197"><a href="#cb50-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-198"><a href="#cb50-198" aria-hidden="true" tabindex="-1"></a><span class="in"># if download manually read it from the local file</span></span>
<span id="cb50-199"><a href="#cb50-199" aria-hidden="true" tabindex="-1"></a><span class="in"># hylaeformis_data &lt;- read.csv("hylaeformis_data.csv", stringsAsFactors = FALSE)</span></span>
<span id="cb50-200"><a href="#cb50-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-201"><a href="#cb50-201" aria-hidden="true" tabindex="-1"></a><span class="in">head(hylaeformis_data, 20)</span></span>
<span id="cb50-202"><a href="#cb50-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-203"><a href="#cb50-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-204"><a href="#cb50-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-205"><a href="#cb50-205" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-206"><a href="#cb50-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-207"><a href="#cb50-207" aria-hidden="true" tabindex="-1"></a>1.1 Create a scatter plot of "duration" vs "meanfreq" (mean frequency)</span>
<span id="cb50-208"><a href="#cb50-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-209"><a href="#cb50-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-210"><a href="#cb50-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-211"><a href="#cb50-211" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = hylaeformis_data, mapping = aes(x = duration, y = meanfreq)) + geom_point()</span></span>
<span id="cb50-212"><a href="#cb50-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-213"><a href="#cb50-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-214"><a href="#cb50-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-215"><a href="#cb50-215" aria-hidden="true" tabindex="-1"></a>1.2 Add a aesthetic attribute to show a different color for each locality</span>
<span id="cb50-216"><a href="#cb50-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-217"><a href="#cb50-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-218"><a href="#cb50-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-219"><a href="#cb50-219" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = hylaeformis_data, mapping = aes(x = duration, y = meanfreq)) + geom_point(aes(color = Locality))</span></span>
<span id="cb50-220"><a href="#cb50-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-221"><a href="#cb50-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-222"><a href="#cb50-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-223"><a href="#cb50-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-224"><a href="#cb50-224" aria-hidden="true" tabindex="-1"></a>1.3 Add another aesthetic attribute to show "dfrange" (dominant frequency range) as the shape size</span>
<span id="cb50-225"><a href="#cb50-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-226"><a href="#cb50-226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-227"><a href="#cb50-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-228"><a href="#cb50-228" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = hylaeformis_data, mapping = aes(x = duration, y = meanfreq)) + geom_point(aes(color = Locality, size = dfrange))</span></span>
<span id="cb50-229"><a href="#cb50-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-230"><a href="#cb50-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-231"><a href="#cb50-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-232"><a href="#cb50-232" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb50-233"><a href="#cb50-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-234"><a href="#cb50-234" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span></span>
<span id="cb50-235"><a href="#cb50-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-236"><a href="#cb50-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Multipanel plots (Facetting)</span></span>
<span id="cb50-237"><a href="#cb50-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-238"><a href="#cb50-238" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Another way to visualize categorical variables</span>
<span id="cb50-239"><a href="#cb50-239" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Allows to create multipanel plots for each level of the variable</span>
<span id="cb50-240"><a href="#cb50-240" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2 types: "grid" &amp; "wrap"</span>
<span id="cb50-241"><a href="#cb50-241" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-244"><a href="#cb50-244" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-245"><a href="#cb50-245" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> </span>
<span id="cb50-246"><a href="#cb50-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb50-247"><a href="#cb50-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species)</span>
<span id="cb50-248"><a href="#cb50-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-249"><a href="#cb50-249" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb50-250"><a href="#cb50-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-251"><a href="#cb50-251" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> </span>
<span id="cb50-252"><a href="#cb50-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb50-253"><a href="#cb50-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Species)</span>
<span id="cb50-254"><a href="#cb50-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-255"><a href="#cb50-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-256"><a href="#cb50-256" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-257"><a href="#cb50-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-258"><a href="#cb50-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-259"><a href="#cb50-259" aria-hidden="true" tabindex="-1"></a>The scale can be fixed or free for the x and y axis, and the number of columns and rows can be modified:</span>
<span id="cb50-260"><a href="#cb50-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-263"><a href="#cb50-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-264"><a href="#cb50-264" aria-hidden="true" tabindex="-1"></a><span class="co"># free x</span></span>
<span id="cb50-265"><a href="#cb50-265" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> </span>
<span id="cb50-266"><a href="#cb50-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb50-267"><a href="#cb50-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Species, <span class="at">scales =</span> <span class="st">"free_x"</span>)</span>
<span id="cb50-268"><a href="#cb50-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-269"><a href="#cb50-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-270"><a href="#cb50-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-271"><a href="#cb50-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8}</span></span>
<span id="cb50-272"><a href="#cb50-272" aria-hidden="true" tabindex="-1"></a><span class="in"># free x and 3 rows</span></span>
<span id="cb50-273"><a href="#cb50-273" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) + </span></span>
<span id="cb50-274"><a href="#cb50-274" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() + </span></span>
<span id="cb50-275"><a href="#cb50-275" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Species, scales = "free_y", nrow = 3)</span></span>
<span id="cb50-276"><a href="#cb50-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-277"><a href="#cb50-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-278"><a href="#cb50-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-279"><a href="#cb50-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=6}</span></span>
<span id="cb50-280"><a href="#cb50-280" aria-hidden="true" tabindex="-1"></a><span class="in"># both free and 2 rows</span></span>
<span id="cb50-281"><a href="#cb50-281" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) + </span></span>
<span id="cb50-282"><a href="#cb50-282" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() + </span></span>
<span id="cb50-283"><a href="#cb50-283" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Species, scales = "free", nrow = 2)</span></span>
<span id="cb50-284"><a href="#cb50-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-285"><a href="#cb50-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-286"><a href="#cb50-286" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-287"><a href="#cb50-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-288"><a href="#cb50-288" aria-hidden="true" tabindex="-1"></a>Note that we can also saved the basic component as an **R** object and add other components later in the code:</span>
<span id="cb50-289"><a href="#cb50-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-290"><a href="#cb50-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8}</span></span>
<span id="cb50-291"><a href="#cb50-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-292"><a href="#cb50-292" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(iris, aes(Sepal.Length, Petal.Length)) + </span></span>
<span id="cb50-293"><a href="#cb50-293" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() </span></span>
<span id="cb50-294"><a href="#cb50-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-295"><a href="#cb50-295" aria-hidden="true" tabindex="-1"></a><span class="in">p + facet_wrap(~Species, scales = "free_x", nrow = 3)</span></span>
<span id="cb50-296"><a href="#cb50-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-297"><a href="#cb50-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-298"><a href="#cb50-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-299"><a href="#cb50-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-300"><a href="#cb50-300" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional "geoms"</span></span>
<span id="cb50-301"><a href="#cb50-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-302"><a href="#cb50-302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_smooth()`</span> - adds best fit lines (including CI)</span>
<span id="cb50-303"><a href="#cb50-303" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_boxplot()`</span> </span>
<span id="cb50-304"><a href="#cb50-304" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_histogram()`</span> &amp; <span class="in">`geom_freqpoly()`</span> - frequency distributions</span>
<span id="cb50-305"><a href="#cb50-305" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_bar()`</span> - frequency distribution of categorical variables</span>
<span id="cb50-306"><a href="#cb50-306" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`geom_path()`</span> &amp; <span class="in">`geom_line()`</span> - add lines to scatter plots</span>
<span id="cb50-307"><a href="#cb50-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-308"><a href="#cb50-308" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-309"><a href="#cb50-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-310"><a href="#cb50-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### geom_smooth()</span></span>
<span id="cb50-311"><a href="#cb50-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-312"><a href="#cb50-312" aria-hidden="true" tabindex="-1"></a>Best fit regression lines can be added with <span class="in">`geom_smooth()`</span>:</span>
<span id="cb50-313"><a href="#cb50-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-314"><a href="#cb50-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=8}</span></span>
<span id="cb50-315"><a href="#cb50-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-316"><a href="#cb50-316" aria-hidden="true" tabindex="-1"></a><span class="in"># smoother and CI</span></span>
<span id="cb50-317"><a href="#cb50-317" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) + </span></span>
<span id="cb50-318"><a href="#cb50-318" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() + </span></span>
<span id="cb50-319"><a href="#cb50-319" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm") +</span></span>
<span id="cb50-320"><a href="#cb50-320" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Species, scales = "free", nrow = 3)</span></span>
<span id="cb50-321"><a href="#cb50-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-322"><a href="#cb50-322" aria-hidden="true" tabindex="-1"></a><span class="in"># without CI</span></span>
<span id="cb50-323"><a href="#cb50-323" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(iris, aes(Sepal.Length, Petal.Length)) + </span></span>
<span id="cb50-324"><a href="#cb50-324" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() + </span></span>
<span id="cb50-325"><a href="#cb50-325" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm", se = FALSE) +</span></span>
<span id="cb50-326"><a href="#cb50-326" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~Species, scales = "free", nrow = 3)</span></span>
<span id="cb50-327"><a href="#cb50-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-328"><a href="#cb50-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-329"><a href="#cb50-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-330"><a href="#cb50-330" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-331"><a href="#cb50-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-332"><a href="#cb50-332" aria-hidden="true" tabindex="-1"></a>&lt;div class="alert alert-info"&gt;</span>
<span id="cb50-333"><a href="#cb50-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-334"><a href="#cb50-334" aria-hidden="true" tabindex="-1"></a>&lt;font size="5"&gt;Exercise 2&lt;/font&gt; </span>
<span id="cb50-335"><a href="#cb50-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-336"><a href="#cb50-336" aria-hidden="true" tabindex="-1"></a>Using the "msleep" example data set:</span>
<span id="cb50-337"><a href="#cb50-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-338"><a href="#cb50-338" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-339"><a href="#cb50-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-340"><a href="#cb50-340" aria-hidden="true" tabindex="-1"></a>2.1 Create a scatter plot of "bodywt"(body weight)  vs "brainwt" (brain weight)</span>
<span id="cb50-341"><a href="#cb50-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-342"><a href="#cb50-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-343"><a href="#cb50-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-344"><a href="#cb50-344" aria-hidden="true" tabindex="-1"></a><span class="in">data(msleep)</span></span>
<span id="cb50-345"><a href="#cb50-345" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = msleep, mapping = aes(x = bodywt, y = brainwt)) + geom_point()</span></span>
<span id="cb50-346"><a href="#cb50-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-347"><a href="#cb50-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-348"><a href="#cb50-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-349"><a href="#cb50-349" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-350"><a href="#cb50-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-351"><a href="#cb50-351" aria-hidden="true" tabindex="-1"></a>2.2 Add "order" as a color aesthetic</span>
<span id="cb50-352"><a href="#cb50-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-353"><a href="#cb50-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-354"><a href="#cb50-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-355"><a href="#cb50-355" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = msleep, mapping = aes(x = bodywt, y = brainwt, color = order)) + </span></span>
<span id="cb50-356"><a href="#cb50-356" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point()</span></span>
<span id="cb50-357"><a href="#cb50-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-358"><a href="#cb50-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-359"><a href="#cb50-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-360"><a href="#cb50-360" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-361"><a href="#cb50-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-362"><a href="#cb50-362" aria-hidden="true" tabindex="-1"></a>2.3 Add a "facet" component to split plots by order using free scales</span>
<span id="cb50-363"><a href="#cb50-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-364"><a href="#cb50-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-365"><a href="#cb50-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-366"><a href="#cb50-366" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = msleep, mapping = aes(x = bodywt, y = brainwt)) + </span></span>
<span id="cb50-367"><a href="#cb50-367" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb50-368"><a href="#cb50-368" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~order, scales = "free")</span></span>
<span id="cb50-369"><a href="#cb50-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-370"><a href="#cb50-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-371"><a href="#cb50-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-372"><a href="#cb50-372" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-373"><a href="#cb50-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-374"><a href="#cb50-374" aria-hidden="true" tabindex="-1"></a>2.4 Remove the orders with less than 4 species in the data set and make a plot similar to 2.3</span>
<span id="cb50-375"><a href="#cb50-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-376"><a href="#cb50-376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-377"><a href="#cb50-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-378"><a href="#cb50-378" aria-hidden="true" tabindex="-1"></a><span class="in">tab &lt;- table(msleep$order)</span></span>
<span id="cb50-379"><a href="#cb50-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-380"><a href="#cb50-380" aria-hidden="true" tabindex="-1"></a><span class="in">ms2 &lt;- msleep[msleep$order %in% names(tab)[tab &gt;= 5], ]</span></span>
<span id="cb50-381"><a href="#cb50-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-382"><a href="#cb50-382" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = ms2, mapping = aes(x = bodywt, y = brainwt)) + </span></span>
<span id="cb50-383"><a href="#cb50-383" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb50-384"><a href="#cb50-384" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(method = "lm") +</span></span>
<span id="cb50-385"><a href="#cb50-385" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~order, scales = "free")</span></span>
<span id="cb50-386"><a href="#cb50-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-387"><a href="#cb50-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-388"><a href="#cb50-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-389"><a href="#cb50-389" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-390"><a href="#cb50-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-391"><a href="#cb50-391" aria-hidden="true" tabindex="-1"></a>2.5 Add a smooth line to each plot in the panel</span>
<span id="cb50-392"><a href="#cb50-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-393"><a href="#cb50-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = FALSE}</span></span>
<span id="cb50-394"><a href="#cb50-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-395"><a href="#cb50-395" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = msleep[msleep$order %in% names(tab)[tab &gt; 3], ], mapping = aes(x = bodywt, y = brainwt)) + </span></span>
<span id="cb50-396"><a href="#cb50-396" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb50-397"><a href="#cb50-397" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth() +</span></span>
<span id="cb50-398"><a href="#cb50-398" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~order, scales = "free")</span></span>
<span id="cb50-399"><a href="#cb50-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-400"><a href="#cb50-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-401"><a href="#cb50-401" aria-hidden="true" tabindex="-1"></a>&lt;/br&gt;</span>
<span id="cb50-402"><a href="#cb50-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-403"><a href="#cb50-403" aria-hidden="true" tabindex="-1"></a>&lt;/div&gt;</span>
<span id="cb50-404"><a href="#cb50-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-405"><a href="#cb50-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-406"><a href="#cb50-406" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplots</span></span>
<span id="cb50-407"><a href="#cb50-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-408"><a href="#cb50-408" aria-hidden="true" tabindex="-1"></a>Again, it only takes a new "geom" component to create a boxplot:</span>
<span id="cb50-409"><a href="#cb50-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-412"><a href="#cb50-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-413"><a href="#cb50-413" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span>
<span id="cb50-414"><a href="#cb50-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-415"><a href="#cb50-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-416"><a href="#cb50-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-417"><a href="#cb50-417" aria-hidden="true" tabindex="-1"></a>An interesting alternative are the violin plots:</span>
<span id="cb50-420"><a href="#cb50-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-421"><a href="#cb50-421" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Species, Petal.Length)) <span class="sc">+</span> <span class="fu">geom_violin</span>()</span>
<span id="cb50-422"><a href="#cb50-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-423"><a href="#cb50-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-424"><a href="#cb50-424" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-425"><a href="#cb50-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-426"><a href="#cb50-426" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histograms</span></span>
<span id="cb50-427"><a href="#cb50-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-428"><a href="#cb50-428" aria-hidden="true" tabindex="-1"></a>Same thing with histrograms and frequency plots:</span>
<span id="cb50-429"><a href="#cb50-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-432"><a href="#cb50-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-433"><a href="#cb50-433" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()</span>
<span id="cb50-434"><a href="#cb50-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-435"><a href="#cb50-435" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_freqpoly</span>()</span>
<span id="cb50-436"><a href="#cb50-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-437"><a href="#cb50-437" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> <span class="fu">geom_histogram</span>()  <span class="sc">+</span> <span class="fu">geom_freqpoly</span>()</span>
<span id="cb50-438"><a href="#cb50-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-439"><a href="#cb50-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-440"><a href="#cb50-440" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-441"><a href="#cb50-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-442"><a href="#cb50-442" aria-hidden="true" tabindex="-1"></a>We can control the width of the bars:</span>
<span id="cb50-445"><a href="#cb50-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-446"><a href="#cb50-446" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length)) <span class="sc">+</span> </span>
<span id="cb50-447"><a href="#cb50-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"red2"</span>, <span class="at">alpha.f =</span> <span class="fl">0.3</span>))</span>
<span id="cb50-448"><a href="#cb50-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-449"><a href="#cb50-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-450"><a href="#cb50-450" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-451"><a href="#cb50-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-452"><a href="#cb50-452" aria-hidden="true" tabindex="-1"></a>And compare the distribution of different groups within the same histogram:</span>
<span id="cb50-455"><a href="#cb50-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-456"><a href="#cb50-456" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Petal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.4</span>)</span>
<span id="cb50-457"><a href="#cb50-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-458"><a href="#cb50-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-459"><a href="#cb50-459" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-460"><a href="#cb50-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-461"><a href="#cb50-461" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bar plots</span></span>
<span id="cb50-462"><a href="#cb50-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-463"><a href="#cb50-463" aria-hidden="true" tabindex="-1"></a>Show the distribution of discrete (categorical) variables:</span>
<span id="cb50-464"><a href="#cb50-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-467"><a href="#cb50-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-468"><a href="#cb50-468" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(msleep<span class="sc">$</span>order)</span>
<span id="cb50-469"><a href="#cb50-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-470"><a href="#cb50-470" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(msleep<span class="sc">$</span>order[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">3</span>]]))</span>
<span id="cb50-471"><a href="#cb50-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-472"><a href="#cb50-472" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span>
<span id="cb50-473"><a href="#cb50-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-474"><a href="#cb50-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-475"><a href="#cb50-475" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-476"><a href="#cb50-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-477"><a href="#cb50-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-478"><a href="#cb50-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=F, echo=F}</span></span>
<span id="cb50-479"><a href="#cb50-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-480"><a href="#cb50-480" aria-hidden="true" tabindex="-1"></a><span class="in"># Calcular el promedio del # de reclutas por estación</span></span>
<span id="cb50-481"><a href="#cb50-481" aria-hidden="true" tabindex="-1"></a><span class="in">df2 &lt;- aggregate(RECRUITS ~ SEASON, df, mean)</span></span>
<span id="cb50-482"><a href="#cb50-482" aria-hidden="true" tabindex="-1"></a><span class="in">names(df2) &lt;- c("season", "rec")  </span></span>
<span id="cb50-483"><a href="#cb50-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-484"><a href="#cb50-484" aria-hidden="true" tabindex="-1"></a><span class="in"># Gráfico de barras</span></span>
<span id="cb50-485"><a href="#cb50-485" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-486"><a href="#cb50-486" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity")</span></span>
<span id="cb50-487"><a href="#cb50-487" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb50-488"><a href="#cb50-488" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb50-489"><a href="#cb50-489" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar la orientación</span></span>
<span id="cb50-490"><a href="#cb50-490" aria-hidden="true" tabindex="-1"></a><span class="in">p + coord_flip()</span></span>
<span id="cb50-491"><a href="#cb50-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-492"><a href="#cb50-492" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar el ancho y colores de las barras ###</span></span>
<span id="cb50-493"><a href="#cb50-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-494"><a href="#cb50-494" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar el ancho de las barras</span></span>
<span id="cb50-495"><a href="#cb50-495" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-496"><a href="#cb50-496" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", width = 0.5)</span></span>
<span id="cb50-497"><a href="#cb50-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-498"><a href="#cb50-498" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-499"><a href="#cb50-499" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", width = 0.2)</span></span>
<span id="cb50-500"><a href="#cb50-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-501"><a href="#cb50-501" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar colores</span></span>
<span id="cb50-502"><a href="#cb50-502" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-503"><a href="#cb50-503" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", color = "blue", fill="white")</span></span>
<span id="cb50-504"><a href="#cb50-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-505"><a href="#cb50-505" aria-hidden="true" tabindex="-1"></a><span class="in"># Remover el tema y agregar barras azules</span></span>
<span id="cb50-506"><a href="#cb50-506" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-507"><a href="#cb50-507" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", fill="steelblue") + theme_minimal()</span></span>
<span id="cb50-508"><a href="#cb50-508" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb50-509"><a href="#cb50-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-510"><a href="#cb50-510" aria-hidden="true" tabindex="-1"></a><span class="in"># Escoger que barras mostrar</span></span>
<span id="cb50-511"><a href="#cb50-511" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_x_discrete(limits = c("Spring", "Winter"))</span></span>
<span id="cb50-512"><a href="#cb50-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-513"><a href="#cb50-513" aria-hidden="true" tabindex="-1"></a><span class="in">### Agregar anotaciones ###</span></span>
<span id="cb50-514"><a href="#cb50-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-515"><a href="#cb50-515" aria-hidden="true" tabindex="-1"></a><span class="in">df2$rec &lt;- round(df2$rec, 1)</span></span>
<span id="cb50-516"><a href="#cb50-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-517"><a href="#cb50-517" aria-hidden="true" tabindex="-1"></a><span class="in"># Fuera de las barras</span></span>
<span id="cb50-518"><a href="#cb50-518" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-519"><a href="#cb50-519" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", fill = "steelblue") +</span></span>
<span id="cb50-520"><a href="#cb50-520" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(aes(label = rec), vjust = -0.3, size = 3.5) +</span></span>
<span id="cb50-521"><a href="#cb50-521" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb50-522"><a href="#cb50-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-523"><a href="#cb50-523" aria-hidden="true" tabindex="-1"></a><span class="in"># Dentro de las barras</span></span>
<span id="cb50-524"><a href="#cb50-524" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df2, aes(season, rec)) +</span></span>
<span id="cb50-525"><a href="#cb50-525" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", fill = "yellow") +</span></span>
<span id="cb50-526"><a href="#cb50-526" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(aes(label = rec), vjust = 1.6, size = 3.5) +</span></span>
<span id="cb50-527"><a href="#cb50-527" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb50-528"><a href="#cb50-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-529"><a href="#cb50-529" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar colores de barras por grupo ###</span></span>
<span id="cb50-530"><a href="#cb50-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-531"><a href="#cb50-531" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar el color de las líneas externas por grupo</span></span>
<span id="cb50-532"><a href="#cb50-532" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec, color = season)) +</span></span>
<span id="cb50-533"><a href="#cb50-533" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", fill = "white")</span></span>
<span id="cb50-534"><a href="#cb50-534" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb50-535"><a href="#cb50-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-536"><a href="#cb50-536" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar el color manualmente ###</span></span>
<span id="cb50-537"><a href="#cb50-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-538"><a href="#cb50-538" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar "palette" predefinido de colores</span></span>
<span id="cb50-539"><a href="#cb50-539" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_color_manual(values = c("red", "blue", "green", "yellow"))</span></span>
<span id="cb50-540"><a href="#cb50-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-541"><a href="#cb50-541" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar "palette brewer"</span></span>
<span id="cb50-542"><a href="#cb50-542" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_color_brewer(palette = "Dark2")</span></span>
<span id="cb50-543"><a href="#cb50-543" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_color_brewer(palette = 1)</span></span>
<span id="cb50-544"><a href="#cb50-544" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_color_brewer(palette = 2)</span></span>
<span id="cb50-545"><a href="#cb50-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-546"><a href="#cb50-546" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar escala de grises</span></span>
<span id="cb50-547"><a href="#cb50-547" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_color_grey() + theme_classic()</span></span>
<span id="cb50-548"><a href="#cb50-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-549"><a href="#cb50-549" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar colores de relleno de las barras ###</span></span>
<span id="cb50-550"><a href="#cb50-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-551"><a href="#cb50-551" aria-hidden="true" tabindex="-1"></a><span class="in"># Color de relleno</span></span>
<span id="cb50-552"><a href="#cb50-552" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb50-553"><a href="#cb50-553" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity") + theme_minimal()</span></span>
<span id="cb50-554"><a href="#cb50-554" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb50-555"><a href="#cb50-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-556"><a href="#cb50-556" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar el color de relleno manualmente ###</span></span>
<span id="cb50-557"><a href="#cb50-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-558"><a href="#cb50-558" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar "palette" predefinido de colores</span></span>
<span id="cb50-559"><a href="#cb50-559" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_manual(values = c("red", "blue", "green", "yellow"))</span></span>
<span id="cb50-560"><a href="#cb50-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-561"><a href="#cb50-561" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar "palette brewer"</span></span>
<span id="cb50-562"><a href="#cb50-562" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_brewer(palette = "Dark2")</span></span>
<span id="cb50-563"><a href="#cb50-563" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_brewer(palette = 1)</span></span>
<span id="cb50-564"><a href="#cb50-564" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_brewer(palette = 2)</span></span>
<span id="cb50-565"><a href="#cb50-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-566"><a href="#cb50-566" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar escala de grises</span></span>
<span id="cb50-567"><a href="#cb50-567" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_grey() + theme_classic()</span></span>
<span id="cb50-568"><a href="#cb50-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-569"><a href="#cb50-569" aria-hidden="true" tabindex="-1"></a><span class="in"># Usar color negro del borde y relleno</span></span>
<span id="cb50-570"><a href="#cb50-570" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb50-571"><a href="#cb50-571" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", color = "black") + </span></span>
<span id="cb50-572"><a href="#cb50-572" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("red", "blue", "green", "yellow")) +</span></span>
<span id="cb50-573"><a href="#cb50-573" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()</span></span>
<span id="cb50-574"><a href="#cb50-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-575"><a href="#cb50-575" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar la posición de la leyenda ###</span></span>
<span id="cb50-576"><a href="#cb50-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-577"><a href="#cb50-577" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar el color de las barras a tonos de azúl</span></span>
<span id="cb50-578"><a href="#cb50-578" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb50-579"><a href="#cb50-579" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity") + theme_minimal()</span></span>
<span id="cb50-580"><a href="#cb50-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-581"><a href="#cb50-581" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- p + scale_fill_brewer(palette = "Blues")</span></span>
<span id="cb50-582"><a href="#cb50-582" aria-hidden="true" tabindex="-1"></a><span class="in">p1 + theme(legend.position = "top")</span></span>
<span id="cb50-583"><a href="#cb50-583" aria-hidden="true" tabindex="-1"></a><span class="in">p1 + theme(legend.position = "bottom")</span></span>
<span id="cb50-584"><a href="#cb50-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-585"><a href="#cb50-585" aria-hidden="true" tabindex="-1"></a><span class="in"># Remover la leyenda</span></span>
<span id="cb50-586"><a href="#cb50-586" aria-hidden="true" tabindex="-1"></a><span class="in">p1 + theme(legend.position = "none") </span></span>
<span id="cb50-587"><a href="#cb50-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-588"><a href="#cb50-588" aria-hidden="true" tabindex="-1"></a><span class="in">### Cambiar el órden de los items en una leyenda ###</span></span>
<span id="cb50-589"><a href="#cb50-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-590"><a href="#cb50-590" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar órden de grupos</span></span>
<span id="cb50-591"><a href="#cb50-591" aria-hidden="true" tabindex="-1"></a><span class="in">p1 + scale_x_discrete(limits = c("Summer", "Autumn", "Winter", "Spring"))</span></span>
<span id="cb50-592"><a href="#cb50-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-593"><a href="#cb50-593" aria-hidden="true" tabindex="-1"></a><span class="in">### Editar aún más los elementos de la leyenda ###</span></span>
<span id="cb50-594"><a href="#cb50-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-595"><a href="#cb50-595" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar el título de la leyenda y la fuente</span></span>
<span id="cb50-596"><a href="#cb50-596" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot(df2, aes(season, rec, fill = season)) +</span></span>
<span id="cb50-597"><a href="#cb50-597" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat = "identity", color = "black")</span></span>
<span id="cb50-598"><a href="#cb50-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-599"><a href="#cb50-599" aria-hidden="true" tabindex="-1"></a><span class="in">titulo &lt;- "Estación"</span></span>
<span id="cb50-600"><a href="#cb50-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-601"><a href="#cb50-601" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- p1 + scale_fill_manual(titulo, values = c("red", "blue", "green", "yellow")) +</span></span>
<span id="cb50-602"><a href="#cb50-602" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()</span></span>
<span id="cb50-603"><a href="#cb50-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-604"><a href="#cb50-604" aria-hidden="true" tabindex="-1"></a><span class="in">p2 + theme(legend.title = element_text(colour = "blue", size = 10,</span></span>
<span id="cb50-605"><a href="#cb50-605" aria-hidden="true" tabindex="-1"></a><span class="in">                                       face = "bold"))</span></span>
<span id="cb50-606"><a href="#cb50-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-607"><a href="#cb50-607" aria-hidden="true" tabindex="-1"></a><span class="in">p2 + theme(legend.text = element_text(colour = "blue", size = 10,</span></span>
<span id="cb50-608"><a href="#cb50-608" aria-hidden="true" tabindex="-1"></a><span class="in">                                       face = "bold"))</span></span>
<span id="cb50-609"><a href="#cb50-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-610"><a href="#cb50-610" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar el color del fondo de la leyenda</span></span>
<span id="cb50-611"><a href="#cb50-611" aria-hidden="true" tabindex="-1"></a><span class="in">p2 + theme(legend.background = element_rect(fill = "lightblue",</span></span>
<span id="cb50-612"><a href="#cb50-612" aria-hidden="true" tabindex="-1"></a><span class="in">                                            size = 0.5, linetype = "solid"))</span></span>
<span id="cb50-613"><a href="#cb50-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-614"><a href="#cb50-614" aria-hidden="true" tabindex="-1"></a><span class="in">p2 + theme(legend.background = element_rect(fill = "lightblue",</span></span>
<span id="cb50-615"><a href="#cb50-615" aria-hidden="true" tabindex="-1"></a><span class="in">                                            size = 0.5, linetype = "solid"))</span></span>
<span id="cb50-616"><a href="#cb50-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-617"><a href="#cb50-617" aria-hidden="true" tabindex="-1"></a><span class="in">### Gráfico de barras con múltiples grupos ###</span></span>
<span id="cb50-618"><a href="#cb50-618" aria-hidden="true" tabindex="-1"></a><span class="in">head(df)</span></span>
<span id="cb50-619"><a href="#cb50-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-620"><a href="#cb50-620" aria-hidden="true" tabindex="-1"></a><span class="in">df.n &lt;- aggregate(RECRUITS ~ SEASON + DENSITY, df, mean)</span></span>
<span id="cb50-621"><a href="#cb50-621" aria-hidden="true" tabindex="-1"></a><span class="in">names(df.n) &lt;- c("season", "density", "rec")</span></span>
<span id="cb50-622"><a href="#cb50-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-623"><a href="#cb50-623" aria-hidden="true" tabindex="-1"></a><span class="in"># Gráfico 1</span></span>
<span id="cb50-624"><a href="#cb50-624" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df.n, aes(season, rec, fill = density)) +</span></span>
<span id="cb50-625"><a href="#cb50-625" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity")</span></span>
<span id="cb50-626"><a href="#cb50-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-627"><a href="#cb50-627" aria-hidden="true" tabindex="-1"></a><span class="in"># Gráfico 2</span></span>
<span id="cb50-628"><a href="#cb50-628" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(df.n, aes(season, rec, fill = density)) +</span></span>
<span id="cb50-629"><a href="#cb50-629" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", position=position_dodge())</span></span>
<span id="cb50-630"><a href="#cb50-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-631"><a href="#cb50-631" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar el color manualmente</span></span>
<span id="cb50-632"><a href="#cb50-632" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df.n, aes(season, rec, fill = density)) +</span></span>
<span id="cb50-633"><a href="#cb50-633" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", color = "black", position=position_dodge()) +</span></span>
<span id="cb50-634"><a href="#cb50-634" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb50-635"><a href="#cb50-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-636"><a href="#cb50-636" aria-hidden="true" tabindex="-1"></a><span class="in">p + theme_classic()</span></span>
<span id="cb50-637"><a href="#cb50-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-638"><a href="#cb50-638" aria-hidden="true" tabindex="-1"></a><span class="in"># Colores manuales</span></span>
<span id="cb50-639"><a href="#cb50-639" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_manual(values = c('#999999','#E69F00')) + theme_classic()</span></span>
<span id="cb50-640"><a href="#cb50-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-641"><a href="#cb50-641" aria-hidden="true" tabindex="-1"></a><span class="in"># Palette de colores</span></span>
<span id="cb50-642"><a href="#cb50-642" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_brewer(palette = "Blues") + theme_classic()</span></span>
<span id="cb50-643"><a href="#cb50-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-644"><a href="#cb50-644" aria-hidden="true" tabindex="-1"></a><span class="in">### Gráficos de barras con error ###</span></span>
<span id="cb50-645"><a href="#cb50-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-646"><a href="#cb50-646" aria-hidden="true" tabindex="-1"></a><span class="in"># Calcular promedio +/- SD</span></span>
<span id="cb50-647"><a href="#cb50-647" aria-hidden="true" tabindex="-1"></a><span class="in">head(df)</span></span>
<span id="cb50-648"><a href="#cb50-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-649"><a href="#cb50-649" aria-hidden="true" tabindex="-1"></a><span class="in">df3 &lt;- aggregate(RECRUITS ~ SEASON + DENSITY, df, FUN = function(x) c(mean = mean(x), sd = sd(x)))</span></span>
<span id="cb50-650"><a href="#cb50-650" aria-hidden="true" tabindex="-1"></a><span class="in">df4 &lt;- cbind(data.frame(df3[,c(1:2)]), df3$RECRUITS[,1], df3$RECRUITS[,2])</span></span>
<span id="cb50-651"><a href="#cb50-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-652"><a href="#cb50-652" aria-hidden="true" tabindex="-1"></a><span class="in">names(df4) &lt;- c("season", "density", "mean", "sd")</span></span>
<span id="cb50-653"><a href="#cb50-653" aria-hidden="true" tabindex="-1"></a><span class="in">str(df4)</span></span>
<span id="cb50-654"><a href="#cb50-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-655"><a href="#cb50-655" aria-hidden="true" tabindex="-1"></a><span class="in"># Grafico de barras y desviación estándar</span></span>
<span id="cb50-656"><a href="#cb50-656" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- ggplot(df4, aes(season, mean, fill = density)) + </span></span>
<span id="cb50-657"><a href="#cb50-657" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", position=position_dodge(), color = "black") +</span></span>
<span id="cb50-658"><a href="#cb50-658" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_errorbar(aes(ymin = mean, ymax = mean + sd), width = 0.2,</span></span>
<span id="cb50-659"><a href="#cb50-659" aria-hidden="true" tabindex="-1"></a><span class="in">                position = position_dodge(0.9))</span></span>
<span id="cb50-660"><a href="#cb50-660" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb50-661"><a href="#cb50-661" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_brewer(palette="Paired") + theme_minimal()</span></span>
<span id="cb50-662"><a href="#cb50-662" aria-hidden="true" tabindex="-1"></a><span class="in">p + scale_fill_brewer(palette="Paired") + theme_classic()</span></span>
<span id="cb50-663"><a href="#cb50-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-664"><a href="#cb50-664" aria-hidden="true" tabindex="-1"></a><span class="in">### Personalizar aún más los gráficos ###</span></span>
<span id="cb50-665"><a href="#cb50-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-666"><a href="#cb50-666" aria-hidden="true" tabindex="-1"></a><span class="in"># Poner títulos de ejes</span></span>
<span id="cb50-667"><a href="#cb50-667" aria-hidden="true" tabindex="-1"></a><span class="in">p + xlab("Estación") + </span></span>
<span id="cb50-668"><a href="#cb50-668" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab("Número de reclutas") +</span></span>
<span id="cb50-669"><a href="#cb50-669" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()</span></span>
<span id="cb50-670"><a href="#cb50-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-671"><a href="#cb50-671" aria-hidden="true" tabindex="-1"></a><span class="in"># Remover títulos de ejes</span></span>
<span id="cb50-672"><a href="#cb50-672" aria-hidden="true" tabindex="-1"></a><span class="in">p + xlab(NULL) + </span></span>
<span id="cb50-673"><a href="#cb50-673" aria-hidden="true" tabindex="-1"></a><span class="in">  ylab(NULL) +</span></span>
<span id="cb50-674"><a href="#cb50-674" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()</span></span>
<span id="cb50-675"><a href="#cb50-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-676"><a href="#cb50-676" aria-hidden="true" tabindex="-1"></a><span class="in"># Otros cambios</span></span>
<span id="cb50-677"><a href="#cb50-677" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- p + labs(x = "Estación", y = "Número de reclutas") + </span></span>
<span id="cb50-678"><a href="#cb50-678" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("black", "grey50")) +</span></span>
<span id="cb50-679"><a href="#cb50-679" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic()</span></span>
<span id="cb50-680"><a href="#cb50-680" aria-hidden="true" tabindex="-1"></a><span class="in">p2</span></span>
<span id="cb50-681"><a href="#cb50-681" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb50-682"><a href="#cb50-682" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar los límites X y Y</span></span>
<span id="cb50-683"><a href="#cb50-683" aria-hidden="true" tabindex="-1"></a><span class="in">p2 + ylim(0,100)</span></span>
<span id="cb50-684"><a href="#cb50-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-685"><a href="#cb50-685" aria-hidden="true" tabindex="-1"></a><span class="in"># Cambiar límites con expand_limits</span></span>
<span id="cb50-686"><a href="#cb50-686" aria-hidden="true" tabindex="-1"></a><span class="in">p2 + expand_limits(x = c(0, 6), y = c(0, 80))</span></span>
<span id="cb50-687"><a href="#cb50-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-688"><a href="#cb50-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-689"><a href="#cb50-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-690"><a href="#cb50-690" aria-hidden="true" tabindex="-1"></a><span class="fu">## Customizing ggplots</span></span>
<span id="cb50-691"><a href="#cb50-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-692"><a href="#cb50-692" aria-hidden="true" tabindex="-1"></a>Besides the basic functions (e.g. components) described above, ggplot has many other tools (both arguments and additional functions) to further customize plots. Pretty much every thing can be modified. Here we see some of the most common tools.</span>
<span id="cb50-693"><a href="#cb50-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-694"><a href="#cb50-694" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-695"><a href="#cb50-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-696"><a href="#cb50-696" aria-hidden="true" tabindex="-1"></a><span class="fu">### Themes</span></span>
<span id="cb50-697"><a href="#cb50-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-698"><a href="#cb50-698" aria-hidden="true" tabindex="-1"></a>ggplot2 comes with some default themes that can be easily applied to modified the look of our plots:</span>
<span id="cb50-699"><a href="#cb50-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-702"><a href="#cb50-702" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-703"><a href="#cb50-703" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> </span>
<span id="cb50-704"><a href="#cb50-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb50-705"><a href="#cb50-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-706"><a href="#cb50-706" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb50-707"><a href="#cb50-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-708"><a href="#cb50-708" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb50-709"><a href="#cb50-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-710"><a href="#cb50-710" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb50-711"><a href="#cb50-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-712"><a href="#cb50-712" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-713"><a href="#cb50-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-714"><a href="#cb50-714" aria-hidden="true" tabindex="-1"></a>Most themes differ in the use of grids, border lines and axis labeling patterns.</span>
<span id="cb50-715"><a href="#cb50-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-716"><a href="#cb50-716" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-717"><a href="#cb50-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-718"><a href="#cb50-718" aria-hidden="true" tabindex="-1"></a><span class="fu">### Axis customization</span></span>
<span id="cb50-719"><a href="#cb50-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-720"><a href="#cb50-720" aria-hidden="true" tabindex="-1"></a>Axis limits can be modified as follows:</span>
<span id="cb50-721"><a href="#cb50-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-724"><a href="#cb50-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-725"><a href="#cb50-725" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length)) <span class="sc">+</span> </span>
<span id="cb50-726"><a href="#cb50-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span> </span>
<span id="cb50-727"><a href="#cb50-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb50-728"><a href="#cb50-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-729"><a href="#cb50-729" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span> </span>
<span id="cb50-730"><a href="#cb50-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span> </span>
<span id="cb50-731"><a href="#cb50-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb50-732"><a href="#cb50-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>))</span>
<span id="cb50-733"><a href="#cb50-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-734"><a href="#cb50-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-735"><a href="#cb50-735" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-736"><a href="#cb50-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-737"><a href="#cb50-737" aria-hidden="true" tabindex="-1"></a>Axis can also be transformed:</span>
<span id="cb50-738"><a href="#cb50-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-741"><a href="#cb50-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-742"><a href="#cb50-742" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span> </span>
<span id="cb50-743"><a href="#cb50-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span> </span>
<span id="cb50-744"><a href="#cb50-744" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log"</span>) <span class="sc">+</span> </span>
<span id="cb50-745"><a href="#cb50-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log2"</span>)</span>
<span id="cb50-746"><a href="#cb50-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-747"><a href="#cb50-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-748"><a href="#cb50-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-749"><a href="#cb50-749" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-750"><a href="#cb50-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-751"><a href="#cb50-751" aria-hidden="true" tabindex="-1"></a>or reversed:</span>
<span id="cb50-752"><a href="#cb50-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-755"><a href="#cb50-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-756"><a href="#cb50-756" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">col =</span> Species)) <span class="sc">+</span> </span>
<span id="cb50-757"><a href="#cb50-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span> </span>
<span id="cb50-758"><a href="#cb50-758" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_reverse</span>() </span>
<span id="cb50-759"><a href="#cb50-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-760"><a href="#cb50-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-761"><a href="#cb50-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-762"><a href="#cb50-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-763"><a href="#cb50-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-764"><a href="#cb50-764" aria-hidden="true" tabindex="-1"></a><span class="fu">### Saving ggplots</span></span>
<span id="cb50-765"><a href="#cb50-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-766"><a href="#cb50-766" aria-hidden="true" tabindex="-1"></a>ggplots can be exported as image files using the <span class="in">`ggsave`</span> function:</span>
<span id="cb50-767"><a href="#cb50-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-770"><a href="#cb50-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-771"><a href="#cb50-771" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> msleep[msleep<span class="sc">$</span>order <span class="sc">%in%</span> <span class="fu">names</span>(tab)[tab <span class="sc">&gt;</span> <span class="dv">5</span>], ], <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bodywt, <span class="at">y =</span> brainwt)) <span class="sc">+</span> </span>
<span id="cb50-772"><a href="#cb50-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-773"><a href="#cb50-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>order, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb50-774"><a href="#cb50-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-775"><a href="#cb50-775" aria-hidden="true" tabindex="-1"></a><span class="co"># Export</span></span>
<span id="cb50-776"><a href="#cb50-776" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"plot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb50-777"><a href="#cb50-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-778"><a href="#cb50-778" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-779"><a href="#cb50-779" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-780"><a href="#cb50-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-781"><a href="#cb50-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-782"><a href="#cb50-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-783"><a href="#cb50-783" aria-hidden="true" tabindex="-1"></a>The image file type will be identify by the extension in the file name</span>
<span id="cb50-784"><a href="#cb50-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-785"><a href="#cb50-785" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-786"><a href="#cb50-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-787"><a href="#cb50-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-788"><a href="#cb50-788" aria-hidden="true" tabindex="-1"></a>Additional axis customizing:</span>
<span id="cb50-789"><a href="#cb50-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-792"><a href="#cb50-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-793"><a href="#cb50-793" aria-hidden="true" tabindex="-1"></a><span class="co"># Log2 scaling of the y axis (with visually-equal spacing)</span></span>
<span id="cb50-794"><a href="#cb50-794" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(scales)</span>
<span id="cb50-795"><a href="#cb50-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-796"><a href="#cb50-796" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="fu">log2_trans</span>())</span>
<span id="cb50-797"><a href="#cb50-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-798"><a href="#cb50-798" aria-hidden="true" tabindex="-1"></a><span class="co"># show exponents</span></span>
<span id="cb50-799"><a href="#cb50-799" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="fu">log2_trans</span>(),</span>
<span id="cb50-800"><a href="#cb50-800" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log2"</span>, <span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">^</span>x),</span>
<span id="cb50-801"><a href="#cb50-801" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log2"</span>, <span class="fu">math_format</span>(<span class="dv">2</span><span class="sc">^</span>.x)))</span>
<span id="cb50-802"><a href="#cb50-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-803"><a href="#cb50-803" aria-hidden="true" tabindex="-1"></a><span class="co"># Percent</span></span>
<span id="cb50-804"><a href="#cb50-804" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent)</span>
<span id="cb50-805"><a href="#cb50-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-806"><a href="#cb50-806" aria-hidden="true" tabindex="-1"></a><span class="co"># dollar</span></span>
<span id="cb50-807"><a href="#cb50-807" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> dollar)</span>
<span id="cb50-808"><a href="#cb50-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-809"><a href="#cb50-809" aria-hidden="true" tabindex="-1"></a><span class="co"># scientific</span></span>
<span id="cb50-810"><a href="#cb50-810" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scientific)</span>
<span id="cb50-811"><a href="#cb50-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-812"><a href="#cb50-812" aria-hidden="true" tabindex="-1"></a><span class="do">### Agregar "tick marks" </span><span class="al">###</span></span>
<span id="cb50-813"><a href="#cb50-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-814"><a href="#cb50-814" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librerías</span></span>
<span id="cb50-815"><a href="#cb50-815" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb50-816"><a href="#cb50-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-817"><a href="#cb50-817" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Animals)</span>
<span id="cb50-818"><a href="#cb50-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-819"><a href="#cb50-819" aria-hidden="true" tabindex="-1"></a><span class="co"># x and y axis are transformed and formatted</span></span>
<span id="cb50-820"><a href="#cb50-820" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(Animals, <span class="fu">aes</span>(<span class="at">x =</span> body, <span class="at">y =</span> brain)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb50-821"><a href="#cb50-821" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb50-822"><a href="#cb50-822" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb50-823"><a href="#cb50-823" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> <span class="fu">trans_breaks</span>(<span class="st">"log10"</span>, <span class="cf">function</span>(x) <span class="dv">10</span><span class="sc">^</span>x),</span>
<span id="cb50-824"><a href="#cb50-824" aria-hidden="true" tabindex="-1"></a>              <span class="at">labels =</span> <span class="fu">trans_format</span>(<span class="st">"log10"</span>, <span class="fu">math_format</span>(<span class="dv">10</span><span class="sc">^</span>.x))) <span class="sc">+</span></span>
<span id="cb50-825"><a href="#cb50-825" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span>
<span id="cb50-826"><a href="#cb50-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-827"><a href="#cb50-827" aria-hidden="true" tabindex="-1"></a><span class="co"># log-log plot without log tick marks</span></span>
<span id="cb50-828"><a href="#cb50-828" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb50-829"><a href="#cb50-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-830"><a href="#cb50-830" aria-hidden="true" tabindex="-1"></a><span class="co"># Show log tick marks</span></span>
<span id="cb50-831"><a href="#cb50-831" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>() </span>
<span id="cb50-832"><a href="#cb50-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-833"><a href="#cb50-833" aria-hidden="true" tabindex="-1"></a><span class="co"># # Log ticks on left and right</span></span>
<span id="cb50-834"><a href="#cb50-834" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"lr"</span>)</span>
<span id="cb50-835"><a href="#cb50-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-836"><a href="#cb50-836" aria-hidden="true" tabindex="-1"></a><span class="co"># All sides</span></span>
<span id="cb50-837"><a href="#cb50-837" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">annotation_logticks</span>(<span class="at">sides =</span> <span class="st">"trbl"</span>)</span>
<span id="cb50-838"><a href="#cb50-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-839"><a href="#cb50-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-840"><a href="#cb50-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-841"><a href="#cb50-841" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-842"><a href="#cb50-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-843"><a href="#cb50-843" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other graphs </span></span>
<span id="cb50-844"><a href="#cb50-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-845"><a href="#cb50-845" aria-hidden="true" tabindex="-1"></a>Many other types of graphs can be generated. Here I show a single example of cool contour and "heatmap" graphs:</span>
<span id="cb50-846"><a href="#cb50-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-849"><a href="#cb50-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-850"><a href="#cb50-850" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(faithful)</span>
<span id="cb50-851"><a href="#cb50-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-852"><a href="#cb50-852" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span> <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> density, <span class="at">colour =</span> ..level..))</span>
<span id="cb50-853"><a href="#cb50-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-854"><a href="#cb50-854" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(faithfuld, <span class="fu">aes</span>(eruptions, waiting)) <span class="sc">+</span> <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">fill =</span> density))</span>
<span id="cb50-855"><a href="#cb50-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-856"><a href="#cb50-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-857"><a href="#cb50-857" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-858"><a href="#cb50-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-859"><a href="#cb50-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-860"><a href="#cb50-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## Other R graphing packages</span></span>
<span id="cb50-861"><a href="#cb50-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-862"><a href="#cb50-862" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ggvis** (interactive ggplots)</span>
<span id="cb50-863"><a href="#cb50-863" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**vcd** (Warnes 2015)</span>
<span id="cb50-864"><a href="#cb50-864" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**plotrix** (Lemon et al. 2006)</span>
<span id="cb50-865"><a href="#cb50-865" aria-hidden="true" tabindex="-1"></a><span class="ss">-    </span>**gplots** (Warnes 2015)</span>
<span id="cb50-866"><a href="#cb50-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-867"><a href="#cb50-867" aria-hidden="true" tabindex="-1"></a>Check the <span class="co">[</span><span class="ot">CRAN Graphics Task View</span><span class="co">](http://cran.r-project.org/web/views/Graphics.html)</span> for a more comprehensive list of graphical tools in **R**.</span>
<span id="cb50-868"><a href="#cb50-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-869"><a href="#cb50-869" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb50-870"><a href="#cb50-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-871"><a href="#cb50-871" aria-hidden="true" tabindex="-1"></a><span class="dv">&amp;nbsp;</span> </span>
<span id="cb50-872"><a href="#cb50-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-873"><a href="#cb50-873" aria-hidden="true" tabindex="-1"></a><span class="fu">## References </span></span>
<span id="cb50-874"><a href="#cb50-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-875"><a href="#cb50-875" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lemon J (2006) Plotrix: a package in the red light district of R. R-News</span>
<span id="cb50-876"><a href="#cb50-876" aria-hidden="true" tabindex="-1"></a>6(4):8–12</span>
<span id="cb50-877"><a href="#cb50-877" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Warnes GR, Bolker B, Bonebakker L, Gentleman R, Liaw WHA, Lumley</span>
<span id="cb50-878"><a href="#cb50-878" aria-hidden="true" tabindex="-1"></a>T, Maechler M, Magnusson A, Moeller S, Schwartz M, Venables B (2015) gplots: various R programming tools for plotting data. R package version 2.17.0. https://CRAN.R-project.org/package=gplots</span>
<span id="cb50-879"><a href="#cb50-879" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wickham H (2010) A layered grammar of graphics. J Comput Graph Stat 19(1):3–28</span>
<span id="cb50-880"><a href="#cb50-880" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Wilkinson L (2005) The grammar of graphics. Statistics and computing, 2nd edn. Springer, New York</span>
<span id="cb50-881"><a href="#cb50-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-882"><a href="#cb50-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-883"><a href="#cb50-883" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb50-884"><a href="#cb50-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-885"><a href="#cb50-885" aria-hidden="true" tabindex="-1"></a>&lt;font size="4"&gt;Session information&lt;/font&gt;</span>
<span id="cb50-886"><a href="#cb50-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-887"><a href="#cb50-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb50-888"><a href="#cb50-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-889"><a href="#cb50-889" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb50-890"><a href="#cb50-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-891"><a href="#cb50-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>