<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reproducibility in the use of taxonomic information</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="reproducible_taxonomy_files/libs/clipboard/clipboard.min.js"></script>
<script src="reproducible_taxonomy_files/libs/quarto-html/quarto.js"></script>
<script src="reproducible_taxonomy_files/libs/quarto-html/popper.min.js"></script>
<script src="reproducible_taxonomy_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="reproducible_taxonomy_files/libs/quarto-html/anchor.min.js"></script>
<link href="reproducible_taxonomy_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="reproducible_taxonomy_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="reproducible_taxonomy_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="reproducible_taxonomy_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="reproducible_taxonomy_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="reproducible_taxonomy_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="reproducible_taxonomy_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#why-taxize" id="toc-why-taxize" class="nav-link" data-scroll-target="#why-taxize"><span class="header-section-number">2</span> Why ‘taxize’?</a></li>
  <li><a href="#what-does-taxize-do" id="toc-what-does-taxize-do" class="nav-link" data-scroll-target="#what-does-taxize-do"><span class="header-section-number">3</span> What does ‘taxize’ do?</a>
  <ul class="collapse">
  <li><a href="#resolves-taxonomic-names" id="toc-resolves-taxonomic-names" class="nav-link" data-scroll-target="#resolves-taxonomic-names"><span class="header-section-number">3.1</span> Resolves Taxonomic Names</a></li>
  <li><a href="#identifies-synonyms" id="toc-identifies-synonyms" class="nav-link" data-scroll-target="#identifies-synonyms"><span class="header-section-number">3.2</span> Identifies Synonyms</a></li>
  <li><a href="#extracts-taxonomic-classification" id="toc-extracts-taxonomic-classification" class="nav-link" data-scroll-target="#extracts-taxonomic-classification"><span class="header-section-number">3.3</span> Extracts Taxonomic Classification</a></li>
  <li><a href="#gets-downstream-names" id="toc-gets-downstream-names" class="nav-link" data-scroll-target="#gets-downstream-names"><span class="header-section-number">3.4</span> Gets Downstream Names</a></li>
  <li><a href="#gets-conservation-status-information" id="toc-gets-conservation-status-information" class="nav-link" data-scroll-target="#gets-conservation-status-information"><span class="header-section-number">3.5</span> Gets Conservation Status Information</a></li>
  </ul></li>
  <li><a href="#examples-of-applications-in-reproducible-science" id="toc-examples-of-applications-in-reproducible-science" class="nav-link" data-scroll-target="#examples-of-applications-in-reproducible-science"><span class="header-section-number">4</span> Examples of Applications in Reproducible Science</a>
  <ul class="collapse">
  <li><a href="#lists-of-hosts-in-thousands-of-communities" id="toc-lists-of-hosts-in-thousands-of-communities" class="nav-link" data-scroll-target="#lists-of-hosts-in-thousands-of-communities"><span class="header-section-number">4.1</span> Lists of Hosts in Thousands of Communities</a></li>
  <li><a href="#camera-trap-data-management" id="toc-camera-trap-data-management" class="nav-link" data-scroll-target="#camera-trap-data-management"><span class="header-section-number">4.2</span> Camera trap data management</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Reproducibility in the use of taxonomic information</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Mostrar todo el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Ocultar todo el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código fuente</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Fecha de publicación</div>
    <div class="quarto-title-meta-contents">
      <p class="date">14 de septiembre de 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>One aspect of scientific reproducibility that is specific to the biological sciences is how taxonomic information is obtained, used, and reported. In the discussion, we address the topics of using vouchers and the importance of adequately documenting the justification of taxonomic identifications. Here we will see a tool for obtaining and curating taxonomic information in a reproducible manner.</p>
<p>We will use the R package <a href="https://github.com/ropensci/taxize">‘taxize’</a>. By the way, the article describing the package was published in the journal <a href="https://f1000research.com/articles/2-191/v2">F1000Research</a>, one of the journals we saw at the beginning of the semester is completely open.</p>
<p align="center">
</p><p><img src="./images/Screenshot_taxize.png" class="img-fluid"></p>
<p align="center">
</p><p><font size="2"><a href="https://f1000research.com/articles/2-191/v2">Chamberlain and Szöcs (2013)</a>.</font></p><font size="2">
<p></p>
</font></section><font size="2">
<section id="why-taxize" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Why ‘taxize’?</h1>
<p>There are online databases from which taxonomic information for various biological organisms can be obtained. However, there are advantages to performing these searches programmatically:</p>
<ol type="1">
<li>it is more efficient if you have to search for many taxa</li>
<li>the search becomes a reproducible part of the workflow</li>
</ol>
<p>The idea of taxize is to make the extraction and use of taxonomic information easy and reproducible.</p>
<p align="center">
</p><p><img src="./images/frogtoon.JPG" class="img-fluid"></p>
<p align="center">
</p><p><font size="2"> Image: Rohan Chakravarty/<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/">CC BY-NC-ND 3.0</a>.</font></p><font size="2">
<p></p>
</font></section><font size="2">
<section id="what-does-taxize-do" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> What does ‘taxize’ do?</h1>
<p>‘taxize’ connects with several <a href="https://f1000research.com/articles/2-191/v2#T1">taxonomic databases</a> and more can be gradually added. This information can be used to carry out common tasks in the research process. For example:</p>
<section id="resolves-taxonomic-names" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="resolves-taxonomic-names"><span class="header-section-number">3.1</span> Resolves Taxonomic Names</h2>
<p>If we have a list of specimens, we may want to know if we are using updated names and if the names we have are spelled correctly. We can do this using the Global Names Resolver <a href="http://resolver.globalnames.org/">(GNR)</a> application from the <a href="https://eol.org/">Encyclopedia of Life</a>, through taxize.</p>
<p>As an example, let’s look at occurrence data that I downloaded from <a href="https://www.gbif.org/">GBIF</a>. I downloaded records of birds from the genus <em>Ramphocelus</em> in Costa Rica, from the National Zoological Collection. Perhaps, I am working with or planning to work with these specimens.</p>
<p>The data is here (https://doi.org/10.15468/dl.d8frtc)</p>
<p>and this is an example of the bird:</p>
<p align="center">
</p><p><img src="./images/Ramphocelus.jpeg" class="img-fluid"></p>
<p align="center">
</p><p>&lt;</p>
<p>font size=“2”&gt; <em>Ramphocelus sanguinolentus</em>, La Fortuna, Costa Rica</p>
<p></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"./additional_files/0098054-200613084148143.csv"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># what are the species in CR?</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Ram.names <span class="ot">&lt;-</span> <span class="fu">levels</span>(dat<span class="sc">$</span>species)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Ram.names</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p>Let’s see which databases I can use to search for the names of my species</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(taxize)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(kableExtra)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data.sources <span class="ot">&lt;-</span> <span class="fu">gnr_datasources</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>data.sources[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>)]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">created_at</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">refresh_period_days</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2012-07-06T11:36:36Z</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Catalogue of Life Checklist</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-07-06T11:38:14Z</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Wikispecies</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T10:31:13Z</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Integrated Taxonomic Information SystemITIS</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T10:47:55Z</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">National Center for Biotechnology Information</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T11:16:43Z</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Index Fungorum (Species Fungorum)</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T11:28:38Z</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">GRIN Taxonomy for Plants</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T11:32:18Z</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Union 4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T12:08:54Z</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Interim Register of Marine and Nonmarine Genera</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T12:40:45Z</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">World Register of Marine Species</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T12:55:04Z</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Freebase</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T13:01:40Z</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">GBIF Backbone Taxonomy</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T15:36:33Z</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Encyclopedia of Life</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:08Z</td>
<td style="text-align: center;">93</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Passiflora vernacular names</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:09Z</td>
<td style="text-align: center;">94</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Inventory of Fish Species in the Wami River Basin</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:09Z</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Pheasant Diversity and Conservation in the Mt. Gaoligonshan Region</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:09Z</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Finding Species</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:10Z</td>
<td style="text-align: center;">97</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Birds of Lindi Forests Plantation</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:11Z</td>
<td style="text-align: center;">98</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Nemertea</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:12Z</td>
<td style="text-align: center;">99</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Kihansi Gorge Amphibian Species Checklist</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:12Z</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Mushroom Observer</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:14Z</td>
<td style="text-align: center;">101</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">TaxonConcept</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:15Z</td>
<td style="text-align: center;">102</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Amphibia and Reptilia of Yunnan</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:17Z</td>
<td style="text-align: center;">103</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Common names of Chilean Plants</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-07-06T11:49:07Z</td>
<td style="text-align: center;">104</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Invasive Species of Belgium</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:20Z</td>
<td style="text-align: center;">105</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">ZooKeys</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:23Z</td>
<td style="text-align: center;">106</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">COA Wildlife Conservation List</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:25Z</td>
<td style="text-align: center;">107</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">AskNature</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:31Z</td>
<td style="text-align: center;">108</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">China: Yunnan, Southern Gaoligongshan, Rapid Biological Inventories Report No. 04</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:34Z</td>
<td style="text-align: center;">109</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Native Orchids from Gaoligongshan Mountains, China</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:37Z</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Illinois Wildflowers</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:45Z</td>
<td style="text-align: center;">112</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Coleorrhyncha Species File</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:21:46Z</td>
<td style="text-align: center;">113</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">/home/dimus/files/dwca/zoological names.zip</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:21:57Z</td>
<td style="text-align: center;">114</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Peces de la zona hidrogeográfica de la Amazonia, Colombia (Spreadsheet)</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:22:04Z</td>
<td style="text-align: center;">115</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Eastern Mediterranean Syllidae</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:22:06Z</td>
<td style="text-align: center;">116</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Gaoligong Shan Medicinal Plants Checklist</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:22:14Z</td>
<td style="text-align: center;">117</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">birds_of_tanzania</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:22:23Z</td>
<td style="text-align: center;">118</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">AmphibiaWeb</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:22:38Z</td>
<td style="text-align: center;">119</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">tanzania_plant_sepecimens</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:22:45Z</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Papahanaumokuakea Marine National Monument</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:23:21Z</td>
<td style="text-align: center;">121</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Taiwanese IUCN species list</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:23:27Z</td>
<td style="text-align: center;">122</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">BioPedia</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:24:06Z</td>
<td style="text-align: center;">123</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">AnAge</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:24:25Z</td>
<td style="text-align: center;">124</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Embioptera Species File</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:24:28Z</td>
<td style="text-align: center;">125</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Global Invasive Species Database</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:24:38Z</td>
<td style="text-align: center;">126</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Sendoya S., Fernández F. AAT de hormigas (Hymenoptera: Formicidae) del Neotrópico 1.0 2004 (Spreadsheet)</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:25:00Z</td>
<td style="text-align: center;">127</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Flora of Gaoligong Mountains</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:25:16Z</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">ARKive</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:25:27Z</td>
<td style="text-align: center;">129</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">True Fruit Flies (Diptera, Tephritidae) of the Afrotropical Region</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:25:30Z</td>
<td style="text-align: center;">130</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">3i - Typhlocybinae Database</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:26:09Z</td>
<td style="text-align: center;">131</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">CATE Sphingidae</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:26:28Z</td>
<td style="text-align: center;">132</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">ZooBank</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:26:44Z</td>
<td style="text-align: center;">133</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Diatoms</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:27:14Z</td>
<td style="text-align: center;">134</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">AntWeb</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:27:40Z</td>
<td style="text-align: center;">135</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Endemic species in Taiwan</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:28:15Z</td>
<td style="text-align: center;">136</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Dermaptera Species File</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:28:21Z</td>
<td style="text-align: center;">137</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Mantodea Species File</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:28:29Z</td>
<td style="text-align: center;">138</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Birds of the World: Recommended English Names</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:29:01Z</td>
<td style="text-align: center;">139</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">New Zealand Animalia</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:30:39Z</td>
<td style="text-align: center;">140</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Blattodea Species File</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:30:57Z</td>
<td style="text-align: center;">141</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Plecoptera Species File</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:31:58Z</td>
<td style="text-align: center;">143</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Coreoidea Species File</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:32:28Z</td>
<td style="text-align: center;">144</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Freshwater Animal Diversity Assessment - Normalized export</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:33:38Z</td>
<td style="text-align: center;">145</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Catalogue of Vascular Plant Species of Central and Northeastern Brazil</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:35:12Z</td>
<td style="text-align: center;">146</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Wikipedia in EOL</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:36:49Z</td>
<td style="text-align: center;">147</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Database of Vascular Plants of Canada (VASCAN)</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:38:13Z</td>
<td style="text-align: center;">148</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Phasmida Species File</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:38:29Z</td>
<td style="text-align: center;">149</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">OBIS</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:40:09Z</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">USDA NRCS PLANTS Database</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:42:04Z</td>
<td style="text-align: center;">151</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Catalog of Fishes</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:43:41Z</td>
<td style="text-align: center;">152</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Aphid Species File</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:44:03Z</td>
<td style="text-align: center;">153</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The National Checklist of Taiwan</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:46:06Z</td>
<td style="text-align: center;">154</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Psocodea Species File</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:46:24Z</td>
<td style="text-align: center;">155</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">FishBase</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:48:19Z</td>
<td style="text-align: center;">156</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">3i - Typhlocybinae Database</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:48:44Z</td>
<td style="text-align: center;">157</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Belgian Species List</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T18:51:49Z</td>
<td style="text-align: center;">158</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">EUNIS</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T18:58:36Z</td>
<td style="text-align: center;">159</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">CU*STAR</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T19:10:42Z</td>
<td style="text-align: center;">161</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Orthoptera Species File</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T19:11:37Z</td>
<td style="text-align: center;">162</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Bishop Museum</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T19:18:20Z</td>
<td style="text-align: center;">163</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">IUCN Red List of Threatened Species</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T19:20:46Z</td>
<td style="text-align: center;">164</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">BioLib.cz</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T19:43:03Z</td>
<td style="text-align: center;">165</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Tropicos - Missouri Botanical Garden</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-02-09T20:05:41Z</td>
<td style="text-align: center;">166</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">nlbif</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-02-09T20:36:27Z</td>
<td style="text-align: center;">167</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The International Plant Names Index</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2012-05-07T13:45:07Z</td>
<td style="text-align: center;">168</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Index to Organism Names</td>
</tr>
<tr class="even">
<td style="text-align: center;">2012-05-07T13:50:15Z</td>
<td style="text-align: center;">169</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">uBio NameBank</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2013-05-31T01:17:28Z</td>
<td style="text-align: center;">170</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Arctos</td>
</tr>
<tr class="even">
<td style="text-align: center;">2013-12-10T03:02:58Z</td>
<td style="text-align: center;">171</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Checklist of Beetles (Coleoptera) of Canada and Alaska. Second Edition.</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2014-12-08T11:17:24Z</td>
<td style="text-align: center;">172</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Paleobiology Database</td>
</tr>
<tr class="even">
<td style="text-align: center;">2014-12-08T19:50:56Z</td>
<td style="text-align: center;">173</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Reptile Database</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2014-12-09T21:27:18Z</td>
<td style="text-align: center;">174</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Mammal Species of The World</td>
</tr>
<tr class="even">
<td style="text-align: center;">2014-12-11T00:19:59Z</td>
<td style="text-align: center;">175</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">BirdLife International</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2015-03-03T13:48:51Z</td>
<td style="text-align: center;">176</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Checklist da Flora de Portugal (Continental, Açores e Madeira)</td>
</tr>
<tr class="even">
<td style="text-align: center;">2016-07-20T11:13:25Z</td>
<td style="text-align: center;">177</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">FishBase Cache</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2016-10-18T20:00:31Z</td>
<td style="text-align: center;">178</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Silva</td>
</tr>
<tr class="even">
<td style="text-align: center;">2016-10-19T10:13:10Z</td>
<td style="text-align: center;">179</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Open Tree of Life Reference Taxonomy</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2016-10-30T00:46:40Z</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">iNaturalist Taxonomy</td>
</tr>
<tr class="even">
<td style="text-align: center;">2016-11-03T16:09:05Z</td>
<td style="text-align: center;">181</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Interim Register of Marine and Nonmarine Genera</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2017-03-22T15:26:50Z</td>
<td style="text-align: center;">182</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Gymno</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-05-25T02:43:22Z</td>
<td style="text-align: center;">183</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Index Animalium by Charles Davies Sherborn</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020-05-25T10:32:16Z</td>
<td style="text-align: center;">184</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">ASM Mammal Diversity Database</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-05-27T01:41:11Z</td>
<td style="text-align: center;">185</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">IOC World Bird List</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020-05-28T00:01:22Z</td>
<td style="text-align: center;">186</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">MCZbase</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-05-28T16:50:17Z</td>
<td style="text-align: center;">187</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The eBird/Clements Checklist of Birds of the World</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020-05-30T00:58:32Z</td>
<td style="text-align: center;">188</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">American Ornithological Society</td>
</tr>
<tr class="even">
<td style="text-align: center;">2020-05-31T00:36:35Z</td>
<td style="text-align: center;">189</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Howard and Moore Complete Checklist of the Birds of the World</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2020-05-31T01:23:24Z</td>
<td style="text-align: center;">193</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Myriatrix</td>
</tr>
<tr class="even">
<td style="text-align: center;">2021-03-19T16:48:41Z</td>
<td style="text-align: center;">194</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">PLAZI treatments</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2021-10-21T12:27:48Z</td>
<td style="text-align: center;">195</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">AlgaeBase</td>
</tr>
<tr class="even">
<td style="text-align: center;">2021-12-28T13:04:34Z</td>
<td style="text-align: center;">196</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">World Flora Online Plant List 2023-12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2021-12-29T13:29:11Z</td>
<td style="text-align: center;">197</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">World Checklist of Vascular Plants</td>
</tr>
<tr class="even">
<td style="text-align: center;">2021-12-30T14:32:51Z</td>
<td style="text-align: center;">198</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Leipzig Catalogue of Vascular Plants</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2022-01-14T22:16:40Z</td>
<td style="text-align: center;">200</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">The Terrestrial Parasite Tracker</td>
</tr>
<tr class="even">
<td style="text-align: center;">2022-02-14T15:59:43Z</td>
<td style="text-align: center;">201</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">ICTV Virus Taxonomy</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2022-02-18T21:58:40Z</td>
<td style="text-align: center;">202</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Discover Life Bee Species Guide</td>
</tr>
<tr class="even">
<td style="text-align: center;">2023-03-01T22:57:31Z</td>
<td style="text-align: center;">203</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">MycoBank</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2023-03-01T23:38:23Z</td>
<td style="text-align: center;">204</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Fungal Names</td>
</tr>
<tr class="even">
<td style="text-align: center;">2023-05-01T16:19:21Z</td>
<td style="text-align: center;">205</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Nomenclator Zoologicus</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2023-08-22T20:12:02Z</td>
<td style="text-align: center;">206</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Ruhoff 1980</td>
</tr>
<tr class="even">
<td style="text-align: center;">2023-10-09T19:23:23Z</td>
<td style="text-align: center;">207</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">Wikidata</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2023-12-06T21:42:18Z</td>
<td style="text-align: center;">208</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">List of Prokaryotic names with Standing in Nomenclature</td>
</tr>
<tr class="even">
<td style="text-align: center;">2023-12-22T12:47:04Z</td>
<td style="text-align: center;">209</td>
<td style="text-align: center;">14</td>
<td style="text-align: center;">New Zealand Organizm Register</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Let’s check if they are spelled correctly</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>name.res <span class="ot">&lt;-</span> <span class="fu">gnr_resolve</span>(<span class="at">sci =</span> Ram.names, <span class="at">data_source_ids =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>name.res[, <span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And what if they weren’t?</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Ram.names2 <span class="ot">&lt;-</span> Ram.names</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Ram.names2[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"Ramphocelus passerini"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>name.res2 <span class="ot">&lt;-</span> <span class="fu">gnr_resolve</span>(<span class="at">sci =</span> Ram.names2, <span class="at">data_source_ids =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>name.res2[, <span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">submitted_name</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">matched_name</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">data_source_title</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Ramphocelus passerini</td>
<td style="text-align: center;">Ramphocelus passerinii Bonaparte, 1831</td>
<td style="text-align: center;">Integrated Taxonomic Information SystemITIS</td>
<td style="text-align: center;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: center;">Ramphocelus passerini</td>
<td style="text-align: center;">Ramphocelus passerinii</td>
<td style="text-align: center;">National Center for Biotechnology Information</td>
<td style="text-align: center;">0.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="identifies-synonyms" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="identifies-synonyms"><span class="header-section-number">3.2</span> Identifies Synonyms</h2>
<p>Let’s search for synonyms for these species</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">synonyms</span>(<span class="at">sci_id =</span> Ram.names, <span class="at">db =</span> <span class="st">"itis"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To use some databases, it is necessary to obtain an ‘API key’. This cannot be done automatically with ‘taxize’ but instructions on how to obtain and save the API key for use from R can be obtained. Let’s look at a couple of examples:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_tropicos</span>()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">use_iucn</span>()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">use_entrez</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for more information</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">?</span><span class="st">`</span>(<span class="fu">key_helpers</span>())</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">?</span><span class="st">`</span>(<span class="st">`</span><span class="at">taxize-authentication</span><span class="st">`</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<style>
div.ejercicios { background-color:#F5F5DC; border-radius: 5px; padding: 5px}
div.discu { background-color:#6699CC; border-radius: 5px; padding: 5px}
</style>
<section id="exercise-1" class="level3 ejercicios" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">3.2.1</span> Exercise 1</h3>
<ol type="1">
<li>Install the ‘usethis’ package with the command <code>install.packages("usethis")</code></li>
<li>Obtain the ‘API key’ for a database of your interest</li>
<li>Add this ‘API key’ to your environment in R with the command <code>usethis::edit_r_environ()</code></li>
<li>Restart R and verify that you have the ‘API key’ using <code>getkey()</code></li>
<li>If everything went well, you’re ready to use it.</li>
</ol>
</section>
<p>&nbsp;</p>
</section>
<section id="extracts-taxonomic-classification" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="extracts-taxonomic-classification"><span class="header-section-number">3.3</span> Extracts Taxonomic Classification</h2>
<p>We can obtain information about the higher taxonomic classification of our species. If your key is for ‘tropicos’ or ‘entrez’, you can use the respective databases (tropicos and ncbi). For example:</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Ram.class <span class="ot">&lt;-</span> <span class="fu">classification</span>(Ram.names, <span class="at">db =</span> <span class="st">"ncbi"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Ram.class[[<span class="dv">1</span>]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>and if we just want to know the family…</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Ram.fam <span class="ot">&lt;-</span> <span class="fu">tax_name</span>(<span class="at">sci =</span> Ram.names, <span class="at">get =</span> <span class="st">"family"</span>, <span class="at">db =</span> <span class="st">"ncbi"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Ram.fam</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed" data-quarto-postprocess="true" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="header">
</tr>

</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="gets-downstream-names" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="gets-downstream-names"><span class="header-section-number">3.4</span> Gets Downstream Names</h2>
<p>Perhaps we want to know which or how many are the members of a certain taxonomic group. For example, how many species are in the genus <em>Ramphocelus</em>?</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># separate the genus</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>genus <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(Ram.names[<span class="dv">1</span>], <span class="st">" "</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get the species</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Ram.down <span class="ot">&lt;-</span> <span class="fu">downstream</span>(<span class="at">sci_id =</span> genus, <span class="at">downto =</span> <span class="st">"species"</span>, <span class="at">db =</span> <span class="st">"ncbi"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>Ram.down[[<span class="dv">1</span>]]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="gets-conservation-status-information" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="gets-conservation-status-information"><span class="header-section-number">3.5</span> Gets Conservation Status Information</h2>
<p>If you have the ‘API key’ for IUCN, you can obtain information about conservation status.</p>
<p><em>NOTE: The authors of ‘taxize’ warn to use with caution as there may be errors</em></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Ram.sum <span class="ot">&lt;-</span> <span class="fu">iucn_summary</span>(Ram.names)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">iucn_status</span>(Ram.sum)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">get_iucn</span>(Ram.names)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="examples-of-applications-in-reproducible-science" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Examples of Applications in Reproducible Science</h1>
<p>Let’s see some examples of how using tools like ‘taxize’ contributes to more reproducible research.</p>
<section id="lists-of-hosts-in-thousands-of-communities" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="lists-of-hosts-in-thousands-of-communities"><span class="header-section-number">4.1</span> Lists of Hosts in Thousands of Communities</h2>
<p align="center">
</p><p><img src="./images/Zoonotic1.png" class="img-fluid"></p>
<p align="center">
</p><p><font size="2"> Article by <a href="https://www.nature.com/articles/s41586-020-2562-8">Gibb et al.&nbsp;2020, Nature</a></font></p><font size="2">
<p></p>
<p><strong>From the methods section:</strong></p>
<p>“<em>We compiled animal host–pathogen associations from several source databases, to provide as comprehensive a dataset as possible of zoonotic host species and their pathogens: the Enhanced Infectious Diseases (EID2) database; the Global Mammal Parasite Database v.2.0 (GMPD2) which collates records of parasites of cetartiodactyls, carnivores and primates; a reservoir hosts database; a mammal–virus associations database; and a rodent zoonotic reservoirs database augmented with pathogen data from the Global Infectious Disease and Epidemiology Network (GIDEON) (Supplementary Table 8). <span style="color: #32CD32;">We harmonized species names across all databases, excluding instances in which either hosts or pathogens could not be classified to species level. To prevent erroneous matches due to misspelling or taxonomic revision, all host species synonyms were accessed from Catalogue Of Life using ‘taxize’ v.0.8.939</span>. Combined, the dataset contained 20,382 associations between 3,883 animal host species and 5,694 pathogen species.</em>”</p>
<p>Let’s see the code from the article and make a small modification to apply the function to our data.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taxize/GBIFr</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(taxize)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(rgbif)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># function to find and resolve taxonomic synonyms based on Encyclopedia of Life</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>findSyns2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get specific species name</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#taxname = hosts_vec[x]</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a small change to use the function with our data</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  taxname <span class="ot">=</span> x</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print progress</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processing:"</span>, taxname, <span class="at">sep=</span><span class="st">" "</span>))</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># phyla</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  phyla <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Chordata"</span>,<span class="st">"Arthropoda"</span>,<span class="st">"Gastropoda"</span>, <span class="st">"Mollusca"</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (1) resolve misspellings</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  taxname_resolved <span class="ot">=</span> <span class="fu">gnr_resolve</span>(taxname, <span class="at">with_canonical_ranks =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>matched_name2[<span class="dv">1</span>]</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(taxname_resolved)){ <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">strsplit</span>(taxname_resolved, <span class="st">" "</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]) <span class="sc">==</span> <span class="dv">2</span> ){ taxa <span class="ot">=</span> taxname_resolved }}</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(taxname_resolved)){ <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">strsplit</span>(taxname_resolved, <span class="st">" "</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]) <span class="sc">&gt;</span> <span class="dv">2</span> ){ taxa <span class="ot">=</span> <span class="fu">paste</span>(<span class="fu">strsplit</span>(taxname_resolved, <span class="st">" "</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">collapse=</span><span class="st">" "</span>)} }</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if taxa == NA, return list with nothing defined </span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(taxa)){   <span class="cf">if</span>(<span class="fu">class</span>(syns)[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">'simpleError'</span>){ <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Original=</span>taxname, <span class="at">Submitted=</span>taxname_resolved, <span class="at">Accepted_name=</span><span class="cn">NA</span>, <span class="at">Selected_family=</span><span class="cn">NA</span>, <span class="at">Selected_order=</span><span class="cn">NA</span>, <span class="at">Selected_class=</span><span class="cn">NA</span>, <span class="at">Synonyms=</span><span class="cn">NA</span>))} }</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (2) remove sub-species categorizations and set 'genus' and 'species' variables</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  genus <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">strsplit</span>(taxa, <span class="st">" "</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)){ genus <span class="ot">=</span> <span class="fu">strsplit</span>(taxa,<span class="st">" "</span>,<span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]; species <span class="ot">=</span> <span class="fu">strsplit</span>(taxa,<span class="st">" "</span>,<span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>] }</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">strsplit</span>(taxa, <span class="st">"_"</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)){ genus <span class="ot">=</span> <span class="fu">strsplit</span>(taxa,<span class="st">"_"</span>,<span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]; species <span class="ot">=</span> <span class="fu">strsplit</span>(taxa,<span class="st">"_"</span>,<span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>] }</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(<span class="fu">strsplit</span>(taxa, <span class="st">" "</span>, <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]) <span class="sc">&gt;</span><span class="dv">3</span> <span class="sc">|</span> <span class="fu">length</span>(<span class="fu">strsplit</span>(taxa, <span class="st">"_"</span> , <span class="at">fixed=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>]) <span class="sc">&gt;</span> <span class="dv">3</span>){ <span class="fu">return</span>(<span class="st">"name error"</span>) }</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(genus)){ genus <span class="ot">=</span> taxa; species <span class="ot">=</span> <span class="cn">NA</span> }</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (3) use genus to lookup family, order, class</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  syns <span class="ot">=</span> <span class="fu">tryCatch</span>( <span class="fu">name_lookup</span>(genus)<span class="sc">$</span>data, <span class="at">error =</span> <span class="cf">function</span>(e) e)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">class</span>(syns)[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">'simpleError'</span>){ <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Original=</span>taxname, <span class="at">Submitted=</span>taxa, <span class="at">Accepted_name=</span><span class="cn">NA</span>, <span class="at">Selected_family=</span><span class="cn">NA</span>, <span class="at">Selected_order=</span><span class="cn">NA</span>, <span class="at">Selected_class=</span><span class="cn">NA</span>, <span class="at">Synonyms=</span><span class="cn">NA</span>))}</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for cases where the lookup does not find a phylum within the specified range</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(<span class="sc">!</span> syns<span class="sc">$</span>phylum <span class="sc">%in%</span> phyla)){</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    fam1 <span class="ot">=</span> syns<span class="sc">$</span>family[ <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>family) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>phylum) ]</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    order1 <span class="ot">=</span> syns<span class="sc">$</span>order[ <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>family) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>phylum) ]</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    class1 <span class="ot">=</span> syns<span class="sc">$</span>class[ <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>family) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>phylum) ]</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    datfam <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">fam1=</span>fam1, <span class="at">order=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fam1), <span class="at">order1=</span>order1, <span class="at">class1=</span>class1)</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select highest frequency fam/class/order combo</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    fam2 <span class="ot">=</span> <span class="fu">as.data.frame</span>( <span class="fu">table</span>(datfam[ , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>)]) )</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    family2 <span class="ot">=</span> <span class="fu">as.vector</span>(fam2[ fam2<span class="sc">$</span>Freq<span class="sc">==</span><span class="fu">max</span>(fam2<span class="sc">$</span>Freq, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"fam1"</span>] ) </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    order2 <span class="ot">=</span> <span class="fu">as.vector</span>(fam2[ fam2<span class="sc">$</span>Freq<span class="sc">==</span><span class="fu">max</span>(fam2<span class="sc">$</span>Freq, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"order1"</span>] )</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    class2 <span class="ot">=</span> <span class="fu">as.vector</span>(fam2[ fam2<span class="sc">$</span>Freq<span class="sc">==</span><span class="fu">max</span>(fam2<span class="sc">$</span>Freq, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"class1"</span>] )</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(fam2) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>      datfam2 <span class="ot">=</span> datfam[datfam<span class="sc">$</span>fam1 <span class="sc">%in%</span> family2, ]</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>      family2 <span class="ot">=</span> <span class="fu">as.vector</span>(datfam2[datfam2<span class="sc">$</span>order <span class="sc">==</span> <span class="fu">min</span>(datfam2<span class="sc">$</span>order, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"fam1"</span>])</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>      order2 <span class="ot">=</span> <span class="fu">as.vector</span>(datfam2[datfam2<span class="sc">$</span>order <span class="sc">==</span> <span class="fu">min</span>(datfam2<span class="sc">$</span>order, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"order1"</span>])</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>      class2 <span class="ot">=</span> <span class="fu">as.vector</span>(datfam2[datfam2<span class="sc">$</span>order <span class="sc">==</span> <span class="fu">min</span>(datfam2<span class="sc">$</span>order, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"class1"</span>])</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {  <span class="co"># for everything else</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    fam1 <span class="ot">=</span> syns<span class="sc">$</span>family[ <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>family) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>phylum) <span class="sc">&amp;</span> (syns<span class="sc">$</span>phylum <span class="sc">%in%</span> phyla) ]</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    order1 <span class="ot">=</span> syns<span class="sc">$</span>order[ <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>family) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>phylum) <span class="sc">&amp;</span> (syns<span class="sc">$</span>phylum <span class="sc">%in%</span> phyla) ]</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>    class1 <span class="ot">=</span> syns<span class="sc">$</span>class[ <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>family) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(syns<span class="sc">$</span>phylum) <span class="sc">&amp;</span> (syns<span class="sc">$</span>phylum <span class="sc">%in%</span> phyla) ]</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    datfam <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">fam1=</span>fam1, <span class="at">order=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(fam1), <span class="at">order1 =</span> order1, <span class="at">class1=</span>class1)</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select highest frequency fam/class/order combo</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    fam2 <span class="ot">=</span> <span class="fu">as.data.frame</span>( <span class="fu">table</span>(datfam[ , <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>)]) )</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    family2 <span class="ot">=</span> <span class="fu">as.vector</span>(fam2[ fam2<span class="sc">$</span>Freq<span class="sc">==</span><span class="fu">max</span>(fam2<span class="sc">$</span>Freq, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"fam1"</span>] ) </span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    order2 <span class="ot">=</span> <span class="fu">as.vector</span>(fam2[ fam2<span class="sc">$</span>Freq<span class="sc">==</span><span class="fu">max</span>(fam2<span class="sc">$</span>Freq, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"order1"</span>] )</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    class2 <span class="ot">=</span> <span class="fu">as.vector</span>(fam2[ fam2<span class="sc">$</span>Freq<span class="sc">==</span><span class="fu">max</span>(fam2<span class="sc">$</span>Freq, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"class1"</span>] )</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># select highest in list if more than one max</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(family2) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>      datfam2 <span class="ot">=</span> datfam[datfam<span class="sc">$</span>fam1 <span class="sc">%in%</span> family2, ]</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>      family2 <span class="ot">=</span> <span class="fu">as.vector</span>(datfam2[datfam2<span class="sc">$</span>order <span class="sc">==</span> <span class="fu">min</span>(datfam2<span class="sc">$</span>order, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"fam1"</span>])</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>      order2 <span class="ot">=</span> <span class="fu">as.vector</span>(datfam2[datfam2<span class="sc">$</span>order <span class="sc">==</span> <span class="fu">min</span>(datfam2<span class="sc">$</span>order, na.rm</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span><span class="cn">TRUE</span>), <span class="st">"order1"</span>])</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>      class2 <span class="ot">=</span> <span class="fu">as.vector</span>(datfam2[datfam2<span class="sc">$</span>order <span class="sc">==</span> <span class="fu">min</span>(datfam2<span class="sc">$</span>order, <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="st">"class1"</span>])</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (4) search for species synonyms in ITIS</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>  syns <span class="ot">=</span> <span class="fu">tryCatch</span>(<span class="fu">suppressMessages</span>(<span class="fu">synonyms</span>(taxa, <span class="at">db=</span><span class="st">'itis'</span>)), <span class="at">error=</span><span class="cf">function</span>(e) e)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">class</span>(syns)[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">'simpleError'</span>){ <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">Original=</span>taxname, <span class="at">Submitted=</span>taxa, <span class="at">Accepted_name=</span><span class="st">"failed"</span>, <span class="at">Selected_family=</span>family2, <span class="at">Selected_order=</span>order2, <span class="at">Selected_class=</span>class2, <span class="at">Synonyms=</span><span class="st">"failed"</span>))}</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>  syns <span class="ot">=</span> <span class="fu">as.data.frame</span>(syns[[<span class="dv">1</span>]])</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get info</span></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>  original <span class="ot">=</span> taxa</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>  accepted_name <span class="ot">=</span> taxa <span class="co"># save accepted name as original searched name</span></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">"acc_name"</span> <span class="sc">%in%</span> <span class="fu">names</span>(syns)){ accepted_name <span class="ot">=</span> syns<span class="sc">$</span>acc_name } <span class="co"># unless search shows that this is not the accepted name</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(<span class="st">"syn_name"</span> <span class="sc">%in%</span> <span class="fu">names</span>(syns)){ synonyms <span class="ot">=</span> <span class="fu">unique</span>(syns<span class="sc">$</span>syn_name) </span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span>{ synonyms <span class="ot">=</span> <span class="cn">NA</span> }</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine into list and add synonyms </span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Original=</span>taxname, </span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Submitted=</span>taxa,</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Accepted_name=</span>accepted_name,</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Selected_family=</span>family2,</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Selected_order=</span>order2,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Selected_class=</span>class2)</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, <span class="fu">replicate</span>(<span class="fu">length</span>(synonyms), result[<span class="dv">1</span>, ], <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>  result<span class="sc">$</span>Synonyms <span class="ot">=</span> synonyms</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a><span class="co"># nest function within a tryCatch call in case of any errors</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>findSyns3 <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">tryCatch</span>(<span class="fu">findSyns2</span>(x), <span class="at">error=</span><span class="cf">function</span>(e) <span class="cn">NULL</span>)</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Earlier, we saw that there’s a name synonymous with <em>Ramphocelus sanguinolentus</em>. What would the function by Gibb et al.&nbsp;do with that?</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Ram.syn1 <span class="ot">&lt;-</span> <span class="fu">findSyns3</span>(<span class="st">"Phlogothraupis sanguinolenta"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing: Phlogothraupis sanguinolenta"
══  1 queries  ═══════════════</code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>Ram.syn1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Original</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Submitted</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Accepted_name</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Selected_family</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Selected_order</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Selected_class</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Synonyms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Phlogothraupis sanguinolenta</td>
<td style="text-align: center;">Phlogothraupis sanguinolenta</td>
<td style="text-align: center;">failed</td>
<td style="text-align: center;">Thraupidae</td>
<td style="text-align: center;">Passeriformes</td>
<td style="text-align: center;">Aves</td>
<td style="text-align: center;">failed</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>And with one that’s misspelled?</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Ram.syn2 <span class="ot">&lt;-</span> <span class="fu">findSyns3</span>(Ram.names2[<span class="dv">2</span>])</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing: Ramphocelus passerini"
══  1 queries  ═══════════════</code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Ram.syn2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Original</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Submitted</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Accepted_name</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Selected_family</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Selected_order</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Selected_class</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Synonyms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Ramphocelus passerini</td>
<td style="text-align: center;">Ramphocelus passerinii</td>
<td style="text-align: center;">failed</td>
<td style="text-align: center;">Thraupidae</td>
<td style="text-align: center;">Passeriformes</td>
<td style="text-align: center;">Aves</td>
<td style="text-align: center;">failed</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</font></section><font size="2">
<section id="camera-trap-data-management" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="camera-trap-data-management"><span class="header-section-number">4.2</span> Camera trap data management</h2>
<p align="center">
</p><p><img src="./images/camtrapR.png" class="img-fluid"></p>
<p align="center">
</p><p><font size="2"> Article by <a href="https://besjournals.onlinelibrary.wiley.com/doi/pdf/10.1111/2041-210X.12600">Niedballa et al.&nbsp;2016,Methods Ecol. Evol.</a></font></p><font size="2">
<p></p>
<p><strong>From the methods section:</strong></p>
<p><em>“Users are free to use any species names (or abbreviations or codes) they wish. If scientific or common species names are used, <span style="color: #32CD32;">the function checkSpeciesNames can check them against the ITIS taxonomic database (www.itis.gov) and returns their matching counterparts (utilizing the R package taxize (Chamberlain &amp; Szöcs 2013) internally)</span>, making sure species names and spelling are standardized and taxonomically sound, and thus making it easier to combine data sets from different studies.”</em></p>
<p>Let’s see some examples from the camtrapR vignettes. We’re not going to download the package because the CRAN version of ‘camtrapR’ is not compatible with the CRAN version of ‘taxize’.</p>
<p align="center">
</p><p><img src="./images/facepalm.jpg" class="img-fluid" style="width:50.0%"></p>
<p></p>
<p>Let’s rewrite the current function updating the arguments of ‘taxize’.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>checkSpeciesNames <span class="ot">&lt;-</span> <span class="cf">function</span>(speciesNames, searchtype, <span class="at">accepted =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ask =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"taxize"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">"Please install the package taxize to run this function"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ritis"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">"Please install the package ritis to run this function"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    searchtype <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(searchtype, <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"scientific"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"common"</span>))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.logical</span>(accepted))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(speciesNames) <span class="sc">|</span> <span class="fu">is.factor</span>(speciesNames))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    speciesNames <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(speciesNames))</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    file.sep <span class="ot">&lt;-</span> .Platform<span class="sc">$</span>file.sep</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    tsns <span class="ot">&lt;-</span> <span class="fu">try</span>(taxize<span class="sc">::</span><span class="fu">get_tsn</span>(<span class="at">sci_com =</span> speciesNames, <span class="at">searchtype =</span> searchtype,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">accepted =</span> accepted, <span class="at">ask =</span> ask, <span class="at">messages =</span> <span class="cn">FALSE</span>))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">inherits</span>(tsns, <span class="st">"try-error"</span>)) {</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"error in get_tsn. Exiting without results:</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            tsns, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">invisible</span>(<span class="cn">NULL</span>))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    tsns <span class="ot">&lt;-</span> taxize<span class="sc">::</span><span class="fu">as.tsn</span>(<span class="fu">unique</span>(tsns), <span class="at">check =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(tsns))) {</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        not.matched <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(tsns))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"found no matches for"</span>, <span class="fu">length</span>(not.matched),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"name(s):</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">paste</span>(speciesNames[not.matched], <span class="at">collapse =</span> <span class="st">", "</span>)),</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">immediate. =</span> <span class="cn">TRUE</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>        tsns_worked <span class="ot">&lt;-</span> taxize<span class="sc">::</span><span class="fu">as.tsn</span>(tsns[<span class="sc">-</span>not.matched], <span class="at">check =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        tsns_worked <span class="ot">&lt;-</span> tsns</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(tsns_worked) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>        scientific <span class="ot">&lt;-</span> common <span class="ot">&lt;-</span> author <span class="ot">&lt;-</span> rankname <span class="ot">&lt;-</span> taxon_status <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>,</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow =</span> <span class="fu">length</span>(tsns_worked), <span class="at">ncol =</span> <span class="dv">2</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(scientific) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"combinedname"</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(common) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"commonName"</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(author) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"authorship"</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(rankname) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"rankname"</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(taxon_status) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"taxonUsageRating"</span>)</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tsns_worked)) {</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>            scientific_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">scientific_name</span>(tsns_worked[i])</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>            common_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">common_names</span>(tsns_worked[i])</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>            author_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">taxon_authorship</span>(tsns_worked[i])</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>            rankname_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">rank_name</span>(tsns_worked[i])</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(scientific_tmp)) {</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>                scientific[i, ] <span class="ot">&lt;-</span> scientific_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"combinedname"</span>)]</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(common_tmp)) {</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(common_tmp<span class="sc">$</span>tsn)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>                  common2 <span class="ot">&lt;-</span> <span class="fu">tapply</span>(common_tmp<span class="sc">$</span>commonName, <span class="at">INDEX =</span> common_tmp<span class="sc">$</span>tsn,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> paste, <span class="at">collapse =</span> file.sep)</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>                  common_tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">commonName =</span> common2, <span class="at">tsn =</span> <span class="fu">rownames</span>(common2),</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>                    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                common[i, ] <span class="ot">&lt;-</span> common_tmp[, <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"commonName"</span>)]</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(author_tmp)) {</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>                author[i, ] <span class="ot">&lt;-</span> author_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"authorship"</span>)]</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(rankname_tmp)) {</span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>                rankname[i, ] <span class="ot">&lt;-</span> rankname_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"rankname"</span>)]</span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (accepted <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>                taxon_status_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">core_metadata</span>(tsns_worked[i])</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(taxon_status_tmp)) {</span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>                  taxon_status[i, ] <span class="ot">&lt;-</span> taxon_status_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"taxonUsageRating"</span>)]</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>        dat.out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">user_name =</span> speciesNames, <span class="at">tsn =</span> <span class="fu">as.numeric</span>(tsns))</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>        dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> scientific, <span class="at">by =</span> <span class="st">"tsn"</span>,</span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>        dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> common, <span class="at">by =</span> <span class="st">"tsn"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>            <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>        dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> author, <span class="at">by =</span> <span class="st">"tsn"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>        dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> rankname, <span class="at">by =</span> <span class="st">"tsn"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>            <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>        dat.out<span class="sc">$</span>itis_url <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>        dat.out<span class="sc">$</span>itis_url[<span class="fu">match</span>(tsns_worked, dat.out<span class="sc">$</span>tsn)] <span class="ot">&lt;-</span> <span class="fu">attributes</span>(tsns_worked)<span class="sc">$</span>uri</span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">colnames</span>(dat.out)[<span class="fu">colnames</span>(dat.out) <span class="sc">==</span> <span class="st">"combinedname"</span>] <span class="ot">&lt;-</span> <span class="st">"scientificName"</span></span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (accepted <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>            dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> taxon_status, <span class="at">by =</span> <span class="st">"tsn"</span>,</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a>                <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a>            dat.out<span class="sc">$</span>taxon_status[<span class="sc">!</span><span class="fu">is.na</span>(dat.out<span class="sc">$</span>tsn)] <span class="ot">&lt;-</span> <span class="st">"valid"</span></span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(dat.out)</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">"found no TSNs for speciesNames"</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, what can we do?</p>
<section id="search-information-by-common-names" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="search-information-by-common-names"><span class="header-section-number">4.2.1</span> Search information by common names</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>checkNames1 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span>(<span class="at">speciesNames =</span> <span class="fu">c</span>(<span class="st">"Bearded Pig"</span>, <span class="st">"Malayan Civet"</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchtype =</span> <span class="st">"common"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Error in curl::curl_fetch_memory(x$url$url, handle = x$url$handle) : 
  SSL peer certificate or SSH remote key was not OK: [www.itis.gov] SSL certificate problem: unable to get local issuer certificate</code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>checkNames1 <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-minimal" data-quarto-postprocess="true" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="header">
</tr>

</tbody>
</table>


</div>
</div>
</section>
<section id="search-information-by-scientific-names-including-subspecies" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="search-information-by-scientific-names-including-subspecies"><span class="header-section-number">4.2.2</span> Search information by scientific names (including subspecies)</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>checkNames2 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span>(<span class="at">speciesNames =</span> <span class="st">"Viverra tangalunga tangalunga"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchtype =</span> <span class="st">"scientific"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Error in curl::curl_fetch_memory(x$url$url, handle = x$url$handle) : 
  SSL peer certificate or SSH remote key was not OK: [www.itis.gov] SSL certificate problem: unable to get local issuer certificate</code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>checkNames2 <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_minimal</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-minimal" data-quarto-postprocess="true" style="font-family: &quot;Trebuchet MS&quot;, verdana, sans-serif; margin-left: auto; margin-right: auto;">
<tbody>
<tr class="header">
</tr>

</tbody>
</table>


</div>
</div>
</section>
<section id="search-information-with-an-incorrect-name" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="search-information-with-an-incorrect-name"><span class="header-section-number">4.2.3</span> Search information with an incorrect name</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>checkNames3 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span>(<span class="at">speciesNames =</span> <span class="st">"Felis bengalensis"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchtype =</span> <span class="st">"scientific"</span>, <span class="at">accepted =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Error in curl::curl_fetch_memory(x$url$url, handle = x$url$handle) : 
  SSL peer certificate or SSH remote key was not OK: [www.itis.gov] SSL certificate problem: unable to get local issuer certificate</code></pre>
</div>
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>checkNames3</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="search-information-with-an-ambiguous-name" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="search-information-with-an-ambiguous-name"><span class="header-section-number">4.2.4</span> Search information with an ambiguous name</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>checkNames4 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span>(<span class="at">speciesNames =</span> <span class="st">"Chevrotain"</span>, <span class="at">searchtype =</span> <span class="st">"common"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># choose from the menu</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>checkNames4</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</font></section><font size="2">
</font></font></section><font size="2"><font size="2">
<section id="references" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">References</h1>
<p>Chamberlain, S. A., &amp; Szöcs, E. (2013). taxize: taxonomic search and retrieval in R. F1000Research, 2.</p>
<hr>
</section>
<section id="session-information" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Session Information</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.2 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

time zone: America/Costa_Rica
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] rgbif_3.7.9      kableExtra_1.4.0 taxize_0.9.100   knitr_1.48      
[5] emo_0.0.0.9000  

loaded via a namespace (and not attached):
 [1] gtable_0.3.5       xfun_0.47          ggplot2_3.5.1      htmlwidgets_1.6.4 
 [5] lattice_0.20-45    vctrs_0.6.5        tools_4.3.2        generics_0.1.3    
 [9] curl_5.2.2         parallel_4.3.2     tibble_3.2.1       fansi_1.0.6       
[13] highr_0.11         pkgconfig_2.0.3    data.table_1.14.10 assertthat_0.2.1  
[17] uuid_1.2-1         lifecycle_1.0.4    conditionz_0.1.0   compiler_4.3.2    
[21] stringr_1.5.1      munsell_0.5.1      ritis_1.0.0        codetools_0.2-18  
[25] htmltools_0.5.8.1  lazyeval_0.2.2     yaml_2.3.10        whisker_0.4.1     
[29] pillar_1.9.0       crayon_1.5.3       solrium_1.2.0      iterators_1.0.14  
[33] foreach_1.5.2      nlme_3.1-155       tidyselect_1.2.1   digest_0.6.37     
[37] stringi_1.8.4      dplyr_1.1.4        purrr_1.0.2        fastmap_1.2.0     
[41] grid_4.3.2         colorspace_2.1-1   cli_3.6.3          magrittr_2.0.3    
[45] bold_1.3.0         triebeard_0.4.1    crul_1.4.0         utf8_1.2.4        
[49] ape_5.8            scales_1.3.0       oai_0.4.0          lubridate_1.9.3   
[53] timechange_0.2.0   httr_1.4.7         rmarkdown_2.28     zoo_1.8-12        
[57] evaluate_0.24.0    viridisLite_0.4.2  rlang_1.1.4        urltools_1.7.3    
[61] Rcpp_1.0.13        glue_1.7.0         httpcode_0.3.0     formatR_1.14      
[65] xml2_1.3.6         svglite_2.1.3      rstudioapi_0.16.0  jsonlite_1.8.8    
[69] plyr_1.8.9         R6_2.5.1           systemfonts_1.1.0 </code></pre>
</div>
</div>
<!-- -->

</section>

</font></font></font></font></main><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Ejecutar el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb32" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Reproducibility in the use of taxonomic information</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = FALSE}</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="in"># devtools::install_github("hadley/emo")</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="in">library("emo")</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="in">library("knitr")</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="in"># options to customize chunk outputs</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy.opts = list(width.cutoff = 65), </span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy = TRUE,</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="in">  message = FALSE</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="in"># this is a customized printing style data frames </span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="in"># screws up tibble function</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="in">tibble &lt;- function(x, ...) { </span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- kbl(x, digits=4, align= 'c', row.names = FALSE) </span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="in">   x &lt;- kable_styling(x, position ="center", full_width = FALSE,  bootstrap_options = c("striped", "hover", "condensed", "responsive")) </span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="in">   asis_output(x)</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="in">registerS3method("knit_print", "data.frame", tibble)</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>One aspect of scientific reproducibility that is specific to the biological sciences is how taxonomic information is obtained, used, and reported. In the discussion, we address the topics of using vouchers and the importance of adequately documenting the justification of taxonomic identifications. Here we will see a tool for obtaining and curating taxonomic information in a reproducible manner.</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>We will use the R package <span class="co">[</span><span class="ot">'taxize'</span><span class="co">](https://github.com/ropensci/taxize)</span>. By the way, the article describing the package was published in the journal <span class="co">[</span><span class="ot">F1000Research</span><span class="co">](https://f1000research.com/articles/2-191/v2)</span>, one of the journals we saw at the beginning of the semester is completely open.</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="al">![](./images/Screenshot_taxize.png)</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>&lt;font size="2"&gt;<span class="co">[</span><span class="ot">Chamberlain and Szöcs (2013)</span><span class="co">](https://f1000research.com/articles/2-191/v2)</span>.</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="fu"># Why 'taxize'?</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>There are online databases from which taxonomic information for various biological organisms can be obtained. However, there are advantages to performing these searches programmatically:</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>it is more efficient if you have to search for many taxa</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>the search becomes a reproducible part of the workflow</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>The idea of taxize is to make the extraction and use of taxonomic information easy and reproducible.</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a><span class="al">![](./images/frogtoon.JPG)</span></span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>&lt;font size="2"&gt; Image: Rohan Chakravarty/<span class="co">[</span><span class="ot">CC BY-NC-ND 3.0</span><span class="co">](https://creativecommons.org/licenses/by-nc-nd/3.0/)</span>.</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a><span class="fu"># What does 'taxize' do?</span></span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>'taxize' connects with several <span class="co">[</span><span class="ot">taxonomic databases</span><span class="co">](https://f1000research.com/articles/2-191/v2#T1)</span> and more can be gradually added. This information can be used to carry out common tasks in the research process. For example:</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resolves Taxonomic Names</span></span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>If we have a list of specimens, we may want to know if we are using updated names and if the names we have are spelled correctly. We can do this using the Global Names Resolver <span class="co">[</span><span class="ot">(GNR)</span><span class="co">](http://resolver.globalnames.org/)</span> application from the <span class="co">[</span><span class="ot">Encyclopedia of Life</span><span class="co">](https://eol.org/)</span>, through taxize.</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>As an example, let's look at occurrence data that I downloaded from <span class="co">[</span><span class="ot">GBIF</span><span class="co">](https://www.gbif.org/)</span>. I downloaded records of birds from the genus *Ramphocelus* in Costa Rica, from the National Zoological Collection. Perhaps, I am working with or planning to work with these specimens.</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>The data is here (https://doi.org/10.15468/dl.d8frtc)</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>and this is an example of the bird:</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a><span class="al">![](./images/Ramphocelus.jpeg)</span></span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a><span class="sc">\&lt;</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>font size="2"<span class="sc">\&gt;</span> *Ramphocelus sanguinolentus*, La Fortuna, Costa Rica</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data</span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"./additional_files/0098054-200613084148143.csv"</span>, <span class="at">header =</span> T, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb32-95"><a href="#cb32-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-96"><a href="#cb32-96" aria-hidden="true" tabindex="-1"></a><span class="co"># what are the species in CR?</span></span>
<span id="cb32-97"><a href="#cb32-97" aria-hidden="true" tabindex="-1"></a>Ram.names <span class="ot">&lt;-</span> <span class="fu">levels</span>(dat<span class="sc">$</span>species)</span>
<span id="cb32-98"><a href="#cb32-98" aria-hidden="true" tabindex="-1"></a>Ram.names</span>
<span id="cb32-99"><a href="#cb32-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-100"><a href="#cb32-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-101"><a href="#cb32-101" aria-hidden="true" tabindex="-1"></a>Let's see which databases I can use to search for the names of my species</span>
<span id="cb32-102"><a href="#cb32-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-103"><a href="#cb32-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb32-104"><a href="#cb32-104" aria-hidden="true" tabindex="-1"></a><span class="in">library(taxize)</span></span>
<span id="cb32-105"><a href="#cb32-105" aria-hidden="true" tabindex="-1"></a><span class="in">require(kableExtra)</span></span>
<span id="cb32-106"><a href="#cb32-106" aria-hidden="true" tabindex="-1"></a><span class="in">data.sources &lt;- gnr_datasources() </span></span>
<span id="cb32-107"><a href="#cb32-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-108"><a href="#cb32-108" aria-hidden="true" tabindex="-1"></a><span class="in">data.sources[,c(1,5,8,9)]</span></span>
<span id="cb32-109"><a href="#cb32-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-110"><a href="#cb32-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-111"><a href="#cb32-111" aria-hidden="true" tabindex="-1"></a>Let's check if they are spelled correctly</span>
<span id="cb32-112"><a href="#cb32-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-113"><a href="#cb32-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb32-114"><a href="#cb32-114" aria-hidden="true" tabindex="-1"></a><span class="in">name.res &lt;- gnr_resolve(sci = Ram.names,data_source_ids = c(3:4))        </span></span>
<span id="cb32-115"><a href="#cb32-115" aria-hidden="true" tabindex="-1"></a><span class="in">name.res[,-1]</span></span>
<span id="cb32-116"><a href="#cb32-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-117"><a href="#cb32-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-118"><a href="#cb32-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-119"><a href="#cb32-119" aria-hidden="true" tabindex="-1"></a>And what if they weren't?</span>
<span id="cb32-120"><a href="#cb32-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-123"><a href="#cb32-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-124"><a href="#cb32-124" aria-hidden="true" tabindex="-1"></a>Ram.names2 <span class="ot">&lt;-</span> Ram.names</span>
<span id="cb32-125"><a href="#cb32-125" aria-hidden="true" tabindex="-1"></a>Ram.names2[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"Ramphocelus passerini"</span></span>
<span id="cb32-126"><a href="#cb32-126" aria-hidden="true" tabindex="-1"></a>name.res2 <span class="ot">&lt;-</span> <span class="fu">gnr_resolve</span>(<span class="at">sci =</span> Ram.names2,<span class="at">data_source_ids =</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>))        </span>
<span id="cb32-127"><a href="#cb32-127" aria-hidden="true" tabindex="-1"></a>name.res2[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb32-128"><a href="#cb32-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-129"><a href="#cb32-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-130"><a href="#cb32-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-131"><a href="#cb32-131" aria-hidden="true" tabindex="-1"></a><span class="fu">## Identifies Synonyms</span></span>
<span id="cb32-132"><a href="#cb32-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-133"><a href="#cb32-133" aria-hidden="true" tabindex="-1"></a>Let's search for synonyms for these species</span>
<span id="cb32-134"><a href="#cb32-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-135"><a href="#cb32-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb32-136"><a href="#cb32-136" aria-hidden="true" tabindex="-1"></a><span class="in">synonyms(sci_id = Ram.names, db = "itis") </span></span>
<span id="cb32-137"><a href="#cb32-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-138"><a href="#cb32-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-139"><a href="#cb32-139" aria-hidden="true" tabindex="-1"></a>To use some databases, it is necessary to obtain an 'API key'. This cannot be done automatically with 'taxize' but instructions on how to obtain and save the API key for use from R can be obtained. Let's look at a couple of examples:</span>
<span id="cb32-140"><a href="#cb32-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-141"><a href="#cb32-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb32-142"><a href="#cb32-142" aria-hidden="true" tabindex="-1"></a><span class="in">use_tropicos()</span></span>
<span id="cb32-143"><a href="#cb32-143" aria-hidden="true" tabindex="-1"></a><span class="in">use_iucn()</span></span>
<span id="cb32-144"><a href="#cb32-144" aria-hidden="true" tabindex="-1"></a><span class="in">use_entrez()</span></span>
<span id="cb32-145"><a href="#cb32-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-146"><a href="#cb32-146" aria-hidden="true" tabindex="-1"></a><span class="in"># for more information</span></span>
<span id="cb32-147"><a href="#cb32-147" aria-hidden="true" tabindex="-1"></a><span class="in">?key_helpers()</span></span>
<span id="cb32-148"><a href="#cb32-148" aria-hidden="true" tabindex="-1"></a><span class="in">?`taxize-authentication`</span></span>
<span id="cb32-149"><a href="#cb32-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-150"><a href="#cb32-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-151"><a href="#cb32-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb32-152"><a href="#cb32-152" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;style&gt;</span></span>
<span id="cb32-153"><a href="#cb32-153" aria-hidden="true" tabindex="-1"></a><span class="in">div.ejercicios { background-color:#F5F5DC; border-radius: 5px; padding: 5px}</span></span>
<span id="cb32-154"><a href="#cb32-154" aria-hidden="true" tabindex="-1"></a><span class="in">div.discu { background-color:#6699CC; border-radius: 5px; padding: 5px}</span></span>
<span id="cb32-155"><a href="#cb32-155" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/style&gt;</span></span>
<span id="cb32-156"><a href="#cb32-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-157"><a href="#cb32-157" aria-hidden="true" tabindex="-1"></a>::: ejercicios</span>
<span id="cb32-158"><a href="#cb32-158" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 1</span></span>
<span id="cb32-159"><a href="#cb32-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-160"><a href="#cb32-160" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Install the 'usethis' package with the command <span class="in">`install.packages("usethis")`</span></span>
<span id="cb32-161"><a href="#cb32-161" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Obtain the 'API key' for a database of your interest</span>
<span id="cb32-162"><a href="#cb32-162" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Add this 'API key' to your environment in R with the command <span class="in">`usethis::edit_r_environ()`</span></span>
<span id="cb32-163"><a href="#cb32-163" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Restart R and verify that you have the 'API key' using <span class="in">`getkey()`</span></span>
<span id="cb32-164"><a href="#cb32-164" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>If everything went well, you're ready to use it.</span>
<span id="cb32-165"><a href="#cb32-165" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb32-166"><a href="#cb32-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-167"><a href="#cb32-167" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb32-168"><a href="#cb32-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-169"><a href="#cb32-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb32-170"><a href="#cb32-170" aria-hidden="true" tabindex="-1"></a><span class="in">getkey(service = "entrez")</span></span>
<span id="cb32-171"><a href="#cb32-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-172"><a href="#cb32-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-173"><a href="#cb32-173" aria-hidden="true" tabindex="-1"></a><span class="fu">## Extracts Taxonomic Classification</span></span>
<span id="cb32-174"><a href="#cb32-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-175"><a href="#cb32-175" aria-hidden="true" tabindex="-1"></a>We can obtain information about the higher taxonomic classification of our species. If your key is for 'tropicos' or 'entrez', you can use the respective databases (tropicos and ncbi). For example:</span>
<span id="cb32-176"><a href="#cb32-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-177"><a href="#cb32-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb32-178"><a href="#cb32-178" aria-hidden="true" tabindex="-1"></a><span class="in">Ram.class &lt;- classification(Ram.names, db = "ncbi")</span></span>
<span id="cb32-179"><a href="#cb32-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-180"><a href="#cb32-180" aria-hidden="true" tabindex="-1"></a><span class="in">Ram.class[[1]]</span></span>
<span id="cb32-181"><a href="#cb32-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-182"><a href="#cb32-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-183"><a href="#cb32-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-184"><a href="#cb32-184" aria-hidden="true" tabindex="-1"></a>and if we just want to know the family...</span>
<span id="cb32-185"><a href="#cb32-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-188"><a href="#cb32-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-189"><a href="#cb32-189" aria-hidden="true" tabindex="-1"></a>Ram.fam <span class="ot">&lt;-</span> <span class="fu">tax_name</span>(<span class="at">sci =</span> Ram.names, <span class="at">get =</span> <span class="st">"family"</span>, <span class="at">db =</span> <span class="st">"ncbi"</span>)</span>
<span id="cb32-190"><a href="#cb32-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-191"><a href="#cb32-191" aria-hidden="true" tabindex="-1"></a>Ram.fam</span>
<span id="cb32-192"><a href="#cb32-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-193"><a href="#cb32-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-194"><a href="#cb32-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-195"><a href="#cb32-195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gets Downstream Names</span></span>
<span id="cb32-196"><a href="#cb32-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-197"><a href="#cb32-197" aria-hidden="true" tabindex="-1"></a>Perhaps we want to know which or how many are the members of a certain taxonomic group. For example, how many species are in the genus *Ramphocelus*?</span>
<span id="cb32-198"><a href="#cb32-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-199"><a href="#cb32-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb32-200"><a href="#cb32-200" aria-hidden="true" tabindex="-1"></a><span class="in"># separate the genus</span></span>
<span id="cb32-201"><a href="#cb32-201" aria-hidden="true" tabindex="-1"></a><span class="in">genus &lt;- strsplit(Ram.names[1], " ")[[1]][1]</span></span>
<span id="cb32-202"><a href="#cb32-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-203"><a href="#cb32-203" aria-hidden="true" tabindex="-1"></a><span class="in"># get the species</span></span>
<span id="cb32-204"><a href="#cb32-204" aria-hidden="true" tabindex="-1"></a><span class="in">Ram.down &lt;- downstream(sci_id = genus, downto = "species", db = "ncbi")</span></span>
<span id="cb32-205"><a href="#cb32-205" aria-hidden="true" tabindex="-1"></a><span class="in">Ram.down[[1]]</span></span>
<span id="cb32-206"><a href="#cb32-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-207"><a href="#cb32-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-208"><a href="#cb32-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-209"><a href="#cb32-209" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gets Conservation Status Information</span></span>
<span id="cb32-210"><a href="#cb32-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-211"><a href="#cb32-211" aria-hidden="true" tabindex="-1"></a>If you have the 'API key' for IUCN, you can obtain information about conservation status.</span>
<span id="cb32-212"><a href="#cb32-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-213"><a href="#cb32-213" aria-hidden="true" tabindex="-1"></a>*NOTE: The authors of 'taxize' warn to use with caution as there may be errors*</span>
<span id="cb32-214"><a href="#cb32-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-215"><a href="#cb32-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=F}</span></span>
<span id="cb32-216"><a href="#cb32-216" aria-hidden="true" tabindex="-1"></a><span class="in">Ram.sum &lt;- iucn_summary(Ram.names)</span></span>
<span id="cb32-217"><a href="#cb32-217" aria-hidden="true" tabindex="-1"></a><span class="in">iucn_status(Ram.sum)</span></span>
<span id="cb32-218"><a href="#cb32-218" aria-hidden="true" tabindex="-1"></a><span class="in">get_iucn(Ram.names)</span></span>
<span id="cb32-219"><a href="#cb32-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-220"><a href="#cb32-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-221"><a href="#cb32-221" aria-hidden="true" tabindex="-1"></a><span class="fu"># Examples of Applications in Reproducible Science</span></span>
<span id="cb32-222"><a href="#cb32-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-223"><a href="#cb32-223" aria-hidden="true" tabindex="-1"></a>Let's see some examples of how using tools like 'taxize' contributes to more reproducible research.</span>
<span id="cb32-224"><a href="#cb32-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-225"><a href="#cb32-225" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lists of Hosts in Thousands of Communities</span></span>
<span id="cb32-226"><a href="#cb32-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-227"><a href="#cb32-227" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-228"><a href="#cb32-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-229"><a href="#cb32-229" aria-hidden="true" tabindex="-1"></a><span class="al">![](./images/Zoonotic1.png)</span></span>
<span id="cb32-230"><a href="#cb32-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-231"><a href="#cb32-231" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-232"><a href="#cb32-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-233"><a href="#cb32-233" aria-hidden="true" tabindex="-1"></a>&lt;font size="2"&gt; Article by <span class="co">[</span><span class="ot">Gibb et al. 2020, Nature</span><span class="co">](https://www.nature.com/articles/s41586-020-2562-8)</span></span>
<span id="cb32-234"><a href="#cb32-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-235"><a href="#cb32-235" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb32-236"><a href="#cb32-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-237"><a href="#cb32-237" aria-hidden="true" tabindex="-1"></a>**From the methods section:**</span>
<span id="cb32-238"><a href="#cb32-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-239"><a href="#cb32-239" aria-hidden="true" tabindex="-1"></a>"*We compiled animal host--pathogen associations from several source databases, to provide as comprehensive a dataset as possible of zoonotic host species and their pathogens: the Enhanced Infectious Diseases (EID2) database; the Global Mammal Parasite Database v.2.0 (GMPD2) which collates records of parasites of cetartiodactyls, carnivores and primates; a reservoir hosts database; a mammal--virus associations database; and a rodent zoonotic reservoirs database augmented with pathogen data from the Global Infectious Disease and Epidemiology Network (GIDEON) (Supplementary Table 8). [We harmonized species names across all databases, excluding instances in which either hosts or pathogens could not be classified to species level. To prevent erroneous matches due to misspelling or taxonomic revision, all host species synonyms were accessed from Catalogue Of Life using 'taxize' v.0.8.939]{style="color: #32CD32;"}. Combined, the dataset contained 20,382 associations between 3,883 animal host species and 5,694 pathogen species.*"</span>
<span id="cb32-240"><a href="#cb32-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-241"><a href="#cb32-241" aria-hidden="true" tabindex="-1"></a>Let's see the code from the article and make a small modification to apply the function to our data.</span>
<span id="cb32-242"><a href="#cb32-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-243"><a href="#cb32-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb32-244"><a href="#cb32-244" aria-hidden="true" tabindex="-1"></a><span class="in"># taxize/GBIFr</span></span>
<span id="cb32-245"><a href="#cb32-245" aria-hidden="true" tabindex="-1"></a><span class="in">require(taxize)</span></span>
<span id="cb32-246"><a href="#cb32-246" aria-hidden="true" tabindex="-1"></a><span class="in">require(rgbif)</span></span>
<span id="cb32-247"><a href="#cb32-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-248"><a href="#cb32-248" aria-hidden="true" tabindex="-1"></a><span class="in"># function to find and resolve taxonomic synonyms based on Encyclopedia of Life</span></span>
<span id="cb32-249"><a href="#cb32-249" aria-hidden="true" tabindex="-1"></a><span class="in">findSyns2 &lt;- function(x){</span></span>
<span id="cb32-250"><a href="#cb32-250" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-251"><a href="#cb32-251" aria-hidden="true" tabindex="-1"></a><span class="in">  # get specific species name</span></span>
<span id="cb32-252"><a href="#cb32-252" aria-hidden="true" tabindex="-1"></a><span class="in">  #taxname = hosts_vec[x]</span></span>
<span id="cb32-253"><a href="#cb32-253" aria-hidden="true" tabindex="-1"></a><span class="in">  # a small change to use the function with our data</span></span>
<span id="cb32-254"><a href="#cb32-254" aria-hidden="true" tabindex="-1"></a><span class="in">  taxname = x</span></span>
<span id="cb32-255"><a href="#cb32-255" aria-hidden="true" tabindex="-1"></a><span class="in">  # print progress</span></span>
<span id="cb32-256"><a href="#cb32-256" aria-hidden="true" tabindex="-1"></a><span class="in">  print(paste("Processing:", taxname, sep=" "))</span></span>
<span id="cb32-257"><a href="#cb32-257" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-258"><a href="#cb32-258" aria-hidden="true" tabindex="-1"></a><span class="in">  # phyla</span></span>
<span id="cb32-259"><a href="#cb32-259" aria-hidden="true" tabindex="-1"></a><span class="in">  phyla = c("Chordata","Arthropoda","Gastropoda", "Mollusca")</span></span>
<span id="cb32-260"><a href="#cb32-260" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-261"><a href="#cb32-261" aria-hidden="true" tabindex="-1"></a><span class="in">  # (1) resolve misspellings</span></span>
<span id="cb32-262"><a href="#cb32-262" aria-hidden="true" tabindex="-1"></a><span class="in">  taxname_resolved = gnr_resolve(taxname, with_canonical_ranks = TRUE)$matched_name2[1]</span></span>
<span id="cb32-263"><a href="#cb32-263" aria-hidden="true" tabindex="-1"></a><span class="in">  if(!is.null(taxname_resolved)){ if(length(strsplit(taxname_resolved, " ", fixed=TRUE)[[1]]) == 2 ){ taxa = taxname_resolved }}</span></span>
<span id="cb32-264"><a href="#cb32-264" aria-hidden="true" tabindex="-1"></a><span class="in">  if(!is.null(taxname_resolved)){ if(length(strsplit(taxname_resolved, " ", fixed=TRUE)[[1]]) &gt; 2 ){ taxa = paste(strsplit(taxname_resolved, " ", fixed=TRUE)[[1]][1:2], collapse=" ")} }</span></span>
<span id="cb32-265"><a href="#cb32-265" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-266"><a href="#cb32-266" aria-hidden="true" tabindex="-1"></a><span class="in">  # if taxa == NA, return list with nothing defined </span></span>
<span id="cb32-267"><a href="#cb32-267" aria-hidden="true" tabindex="-1"></a><span class="in">  if(is.na(taxa)){   if(class(syns)[1] == 'simpleError'){ return(data.frame(Original=taxname, Submitted=taxname_resolved, Accepted_name=NA, Selected_family=NA, Selected_order=NA, Selected_class=NA, Synonyms=NA))} }</span></span>
<span id="cb32-268"><a href="#cb32-268" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-269"><a href="#cb32-269" aria-hidden="true" tabindex="-1"></a><span class="in">  # (2) remove sub-species categorizations and set 'genus' and 'species' variables</span></span>
<span id="cb32-270"><a href="#cb32-270" aria-hidden="true" tabindex="-1"></a><span class="in">  genus = NULL</span></span>
<span id="cb32-271"><a href="#cb32-271" aria-hidden="true" tabindex="-1"></a><span class="in">  if(length(strsplit(taxa, " ", fixed=TRUE)[[1]]) %in% c(2,3)){ genus = strsplit(taxa," ",fixed=TRUE)[[1]][1]; species = strsplit(taxa," ",fixed=TRUE)[[1]][2] }</span></span>
<span id="cb32-272"><a href="#cb32-272" aria-hidden="true" tabindex="-1"></a><span class="in">  if(length(strsplit(taxa, "_", fixed=TRUE)[[1]]) %in% c(2,3)){ genus = strsplit(taxa,"_",fixed=TRUE)[[1]][1]; species = strsplit(taxa,"_",fixed=TRUE)[[1]][2] }</span></span>
<span id="cb32-273"><a href="#cb32-273" aria-hidden="true" tabindex="-1"></a><span class="in">  if(length(strsplit(taxa, " ", fixed=TRUE)[[1]]) &gt;3 | length(strsplit(taxa, "_" , fixed=TRUE)[[1]][1]) &gt; 3){ return("name error") }</span></span>
<span id="cb32-274"><a href="#cb32-274" aria-hidden="true" tabindex="-1"></a><span class="in">  if(is.null(genus)){ genus = taxa; species = NA }</span></span>
<span id="cb32-275"><a href="#cb32-275" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-276"><a href="#cb32-276" aria-hidden="true" tabindex="-1"></a><span class="in">  # (3) use genus to lookup family, order, class</span></span>
<span id="cb32-277"><a href="#cb32-277" aria-hidden="true" tabindex="-1"></a><span class="in">  syns = tryCatch( name_lookup(genus)$data, error = function(e) e)</span></span>
<span id="cb32-278"><a href="#cb32-278" aria-hidden="true" tabindex="-1"></a><span class="in">  if(class(syns)[1] == 'simpleError'){ return(data.frame(Original=taxname, Submitted=taxa, Accepted_name=NA, Selected_family=NA, Selected_order=NA, Selected_class=NA, Synonyms=NA))}</span></span>
<span id="cb32-279"><a href="#cb32-279" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-280"><a href="#cb32-280" aria-hidden="true" tabindex="-1"></a><span class="in">  # for cases where the lookup does not find a phylum within the specified range</span></span>
<span id="cb32-281"><a href="#cb32-281" aria-hidden="true" tabindex="-1"></a><span class="in">  if(all(! syns$phylum %in% phyla)){</span></span>
<span id="cb32-282"><a href="#cb32-282" aria-hidden="true" tabindex="-1"></a><span class="in">    fam1 = syns$family[ !is.na(syns$family) &amp; !is.na(syns$phylum) ]</span></span>
<span id="cb32-283"><a href="#cb32-283" aria-hidden="true" tabindex="-1"></a><span class="in">    order1 = syns$order[ !is.na(syns$family) &amp; !is.na(syns$phylum) ]</span></span>
<span id="cb32-284"><a href="#cb32-284" aria-hidden="true" tabindex="-1"></a><span class="in">    class1 = syns$class[ !is.na(syns$family) &amp; !is.na(syns$phylum) ]</span></span>
<span id="cb32-285"><a href="#cb32-285" aria-hidden="true" tabindex="-1"></a><span class="in">    datfam = data.frame(fam1=fam1, order=1:length(fam1), order1=order1, class1=class1)</span></span>
<span id="cb32-286"><a href="#cb32-286" aria-hidden="true" tabindex="-1"></a><span class="in">    # select highest frequency fam/class/order combo</span></span>
<span id="cb32-287"><a href="#cb32-287" aria-hidden="true" tabindex="-1"></a><span class="in">    fam2 = as.data.frame( table(datfam[ , c(1,3,4)]) )</span></span>
<span id="cb32-288"><a href="#cb32-288" aria-hidden="true" tabindex="-1"></a><span class="in">    family2 = as.vector(fam2[ fam2$Freq==max(fam2$Freq, na.rm=TRUE), "fam1"] ) </span></span>
<span id="cb32-289"><a href="#cb32-289" aria-hidden="true" tabindex="-1"></a><span class="in">    order2 = as.vector(fam2[ fam2$Freq==max(fam2$Freq, na.rm=TRUE), "order1"] )</span></span>
<span id="cb32-290"><a href="#cb32-290" aria-hidden="true" tabindex="-1"></a><span class="in">    class2 = as.vector(fam2[ fam2$Freq==max(fam2$Freq, na.rm=TRUE), "class1"] )</span></span>
<span id="cb32-291"><a href="#cb32-291" aria-hidden="true" tabindex="-1"></a><span class="in">    if(length(fam2) &gt; 1){</span></span>
<span id="cb32-292"><a href="#cb32-292" aria-hidden="true" tabindex="-1"></a><span class="in">      datfam2 = datfam[datfam$fam1 %in% family2, ]</span></span>
<span id="cb32-293"><a href="#cb32-293" aria-hidden="true" tabindex="-1"></a><span class="in">      family2 = as.vector(datfam2[datfam2$order == min(datfam2$order, na.rm=TRUE), "fam1"])</span></span>
<span id="cb32-294"><a href="#cb32-294" aria-hidden="true" tabindex="-1"></a><span class="in">      order2 = as.vector(datfam2[datfam2$order == min(datfam2$order, na.rm=TRUE), "order1"])</span></span>
<span id="cb32-295"><a href="#cb32-295" aria-hidden="true" tabindex="-1"></a><span class="in">      class2 = as.vector(datfam2[datfam2$order == min(datfam2$order, na.rm=TRUE), "class1"])</span></span>
<span id="cb32-296"><a href="#cb32-296" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb32-297"><a href="#cb32-297" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {  # for everything else</span></span>
<span id="cb32-298"><a href="#cb32-298" aria-hidden="true" tabindex="-1"></a><span class="in">    fam1 = syns$family[ !is.na(syns$family) &amp; !is.na(syns$phylum) &amp; (syns$phylum %in% phyla) ]</span></span>
<span id="cb32-299"><a href="#cb32-299" aria-hidden="true" tabindex="-1"></a><span class="in">    order1 = syns$order[ !is.na(syns$family) &amp; !is.na(syns$phylum) &amp; (syns$phylum %in% phyla) ]</span></span>
<span id="cb32-300"><a href="#cb32-300" aria-hidden="true" tabindex="-1"></a><span class="in">    class1 = syns$class[ !is.na(syns$family) &amp; !is.na(syns$phylum) &amp; (syns$phylum %in% phyla) ]</span></span>
<span id="cb32-301"><a href="#cb32-301" aria-hidden="true" tabindex="-1"></a><span class="in">    datfam = data.frame(fam1=fam1, order=1:length(fam1), order1 = order1, class1=class1)</span></span>
<span id="cb32-302"><a href="#cb32-302" aria-hidden="true" tabindex="-1"></a><span class="in">    # select highest frequency fam/class/order combo</span></span>
<span id="cb32-303"><a href="#cb32-303" aria-hidden="true" tabindex="-1"></a><span class="in">    fam2 = as.data.frame( table(datfam[ , c(1,3,4)]) )</span></span>
<span id="cb32-304"><a href="#cb32-304" aria-hidden="true" tabindex="-1"></a><span class="in">    family2 = as.vector(fam2[ fam2$Freq==max(fam2$Freq, na.rm=TRUE), "fam1"] ) </span></span>
<span id="cb32-305"><a href="#cb32-305" aria-hidden="true" tabindex="-1"></a><span class="in">    order2 = as.vector(fam2[ fam2$Freq==max(fam2$Freq, na.rm=TRUE), "order1"] )</span></span>
<span id="cb32-306"><a href="#cb32-306" aria-hidden="true" tabindex="-1"></a><span class="in">    class2 = as.vector(fam2[ fam2$Freq==max(fam2$Freq, na.rm=TRUE), "class1"] )</span></span>
<span id="cb32-307"><a href="#cb32-307" aria-hidden="true" tabindex="-1"></a><span class="in">    # select highest in list if more than one max</span></span>
<span id="cb32-308"><a href="#cb32-308" aria-hidden="true" tabindex="-1"></a><span class="in">    if(length(family2) &gt; 1){</span></span>
<span id="cb32-309"><a href="#cb32-309" aria-hidden="true" tabindex="-1"></a><span class="in">      datfam2 = datfam[datfam$fam1 %in% family2, ]</span></span>
<span id="cb32-310"><a href="#cb32-310" aria-hidden="true" tabindex="-1"></a><span class="in">      family2 = as.vector(datfam2[datfam2$order == min(datfam2$order, na.rm=TRUE), "fam1"])</span></span>
<span id="cb32-311"><a href="#cb32-311" aria-hidden="true" tabindex="-1"></a><span class="in">      order2 = as.vector(datfam2[datfam2$order == min(datfam2$order, na.rm</span></span>
<span id="cb32-312"><a href="#cb32-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-313"><a href="#cb32-313" aria-hidden="true" tabindex="-1"></a><span class="in">=TRUE), "order1"])</span></span>
<span id="cb32-314"><a href="#cb32-314" aria-hidden="true" tabindex="-1"></a><span class="in">      class2 = as.vector(datfam2[datfam2$order == min(datfam2$order, na.rm=TRUE), "class1"])</span></span>
<span id="cb32-315"><a href="#cb32-315" aria-hidden="true" tabindex="-1"></a><span class="in">    } </span></span>
<span id="cb32-316"><a href="#cb32-316" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb32-317"><a href="#cb32-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-318"><a href="#cb32-318" aria-hidden="true" tabindex="-1"></a><span class="in">  # (4) search for species synonyms in ITIS</span></span>
<span id="cb32-319"><a href="#cb32-319" aria-hidden="true" tabindex="-1"></a><span class="in">  syns = tryCatch(suppressMessages(synonyms(taxa, db='itis')), error=function(e) e)</span></span>
<span id="cb32-320"><a href="#cb32-320" aria-hidden="true" tabindex="-1"></a><span class="in">  if(class(syns)[1] == 'simpleError'){ return(data.frame(Original=taxname, Submitted=taxa, Accepted_name="failed", Selected_family=family2, Selected_order=order2, Selected_class=class2, Synonyms="failed"))}</span></span>
<span id="cb32-321"><a href="#cb32-321" aria-hidden="true" tabindex="-1"></a><span class="in">  syns = as.data.frame(syns[[1]])</span></span>
<span id="cb32-322"><a href="#cb32-322" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-323"><a href="#cb32-323" aria-hidden="true" tabindex="-1"></a><span class="in">  # get info</span></span>
<span id="cb32-324"><a href="#cb32-324" aria-hidden="true" tabindex="-1"></a><span class="in">  original = taxa</span></span>
<span id="cb32-325"><a href="#cb32-325" aria-hidden="true" tabindex="-1"></a><span class="in">  accepted_name = taxa # save accepted name as original searched name</span></span>
<span id="cb32-326"><a href="#cb32-326" aria-hidden="true" tabindex="-1"></a><span class="in">  if("acc_name" %in% names(syns)){ accepted_name = syns$acc_name } # unless search shows that this is not the accepted name</span></span>
<span id="cb32-327"><a href="#cb32-327" aria-hidden="true" tabindex="-1"></a><span class="in">   if("syn_name" %in% names(syns)){ synonyms = unique(syns$syn_name) </span></span>
<span id="cb32-328"><a href="#cb32-328" aria-hidden="true" tabindex="-1"></a><span class="in">  } else{ synonyms = NA }</span></span>
<span id="cb32-329"><a href="#cb32-329" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-330"><a href="#cb32-330" aria-hidden="true" tabindex="-1"></a><span class="in">  # combine into list and add synonyms </span></span>
<span id="cb32-331"><a href="#cb32-331" aria-hidden="true" tabindex="-1"></a><span class="in">  result = data.frame(Original=taxname, </span></span>
<span id="cb32-332"><a href="#cb32-332" aria-hidden="true" tabindex="-1"></a><span class="in">                      Submitted=taxa,</span></span>
<span id="cb32-333"><a href="#cb32-333" aria-hidden="true" tabindex="-1"></a><span class="in">                      Accepted_name=accepted_name,</span></span>
<span id="cb32-334"><a href="#cb32-334" aria-hidden="true" tabindex="-1"></a><span class="in">                      Selected_family=family2,</span></span>
<span id="cb32-335"><a href="#cb32-335" aria-hidden="true" tabindex="-1"></a><span class="in">                      Selected_order=order2,</span></span>
<span id="cb32-336"><a href="#cb32-336" aria-hidden="true" tabindex="-1"></a><span class="in">                      Selected_class=class2)</span></span>
<span id="cb32-337"><a href="#cb32-337" aria-hidden="true" tabindex="-1"></a><span class="in">  result = do.call("rbind", replicate(length(synonyms), result[1, ], simplify = FALSE))</span></span>
<span id="cb32-338"><a href="#cb32-338" aria-hidden="true" tabindex="-1"></a><span class="in">  result$Synonyms = synonyms</span></span>
<span id="cb32-339"><a href="#cb32-339" aria-hidden="true" tabindex="-1"></a><span class="in">  return(result)</span></span>
<span id="cb32-340"><a href="#cb32-340" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb32-341"><a href="#cb32-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-342"><a href="#cb32-342" aria-hidden="true" tabindex="-1"></a><span class="in"># nest function within a tryCatch call in case of any errors</span></span>
<span id="cb32-343"><a href="#cb32-343" aria-hidden="true" tabindex="-1"></a><span class="in">findSyns3 = function(x){</span></span>
<span id="cb32-344"><a href="#cb32-344" aria-hidden="true" tabindex="-1"></a><span class="in">  result = tryCatch(findSyns2(x), error=function(e) NULL)</span></span>
<span id="cb32-345"><a href="#cb32-345" aria-hidden="true" tabindex="-1"></a><span class="in">  return(result)</span></span>
<span id="cb32-346"><a href="#cb32-346" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb32-347"><a href="#cb32-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-348"><a href="#cb32-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-349"><a href="#cb32-349" aria-hidden="true" tabindex="-1"></a>Earlier, we saw that there's a name synonymous with *Ramphocelus sanguinolentus*. What would the function by Gibb et al. do with that?</span>
<span id="cb32-350"><a href="#cb32-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-353"><a href="#cb32-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-354"><a href="#cb32-354" aria-hidden="true" tabindex="-1"></a>Ram.syn1 <span class="ot">&lt;-</span> <span class="fu">findSyns3</span>(<span class="st">"Phlogothraupis sanguinolenta"</span>)</span>
<span id="cb32-355"><a href="#cb32-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-356"><a href="#cb32-356" aria-hidden="true" tabindex="-1"></a>Ram.syn1</span>
<span id="cb32-357"><a href="#cb32-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-358"><a href="#cb32-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-359"><a href="#cb32-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-360"><a href="#cb32-360" aria-hidden="true" tabindex="-1"></a>And with one that's misspelled?</span>
<span id="cb32-361"><a href="#cb32-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-364"><a href="#cb32-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-365"><a href="#cb32-365" aria-hidden="true" tabindex="-1"></a>Ram.syn2 <span class="ot">&lt;-</span> <span class="fu">findSyns3</span>(Ram.names2[<span class="dv">2</span>])</span>
<span id="cb32-366"><a href="#cb32-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-367"><a href="#cb32-367" aria-hidden="true" tabindex="-1"></a>Ram.syn2</span>
<span id="cb32-368"><a href="#cb32-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-369"><a href="#cb32-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-370"><a href="#cb32-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-371"><a href="#cb32-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Camera trap data management</span></span>
<span id="cb32-372"><a href="#cb32-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-373"><a href="#cb32-373" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-374"><a href="#cb32-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-375"><a href="#cb32-375" aria-hidden="true" tabindex="-1"></a><span class="al">![](./images/camtrapR.png)</span></span>
<span id="cb32-376"><a href="#cb32-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-377"><a href="#cb32-377" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-378"><a href="#cb32-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-379"><a href="#cb32-379" aria-hidden="true" tabindex="-1"></a>&lt;font size="2"&gt; Article by <span class="co">[</span><span class="ot">Niedballa et al. 2016,Methods Ecol. Evol.</span><span class="co">](https://besjournals.onlinelibrary.wiley.com/doi/pdf/10.1111/2041-210X.12600)</span></span>
<span id="cb32-380"><a href="#cb32-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-381"><a href="#cb32-381" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb32-382"><a href="#cb32-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-383"><a href="#cb32-383" aria-hidden="true" tabindex="-1"></a>**From the methods section:**</span>
<span id="cb32-384"><a href="#cb32-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-385"><a href="#cb32-385" aria-hidden="true" tabindex="-1"></a>*"Users are free to use any species names (or abbreviations or codes) they wish. If scientific or common species names are used, [the function checkSpeciesNames can check them against the ITIS taxonomic database (www.itis.gov) and returns their matching counterparts (utilizing the R package taxize (Chamberlain &amp; Szöcs 2013) internally)]{style="color: #32CD32;"}, making sure species names and spelling are standardized and taxonomically sound, and thus making it easier to combine data sets from different studies."*</span>
<span id="cb32-386"><a href="#cb32-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-387"><a href="#cb32-387" aria-hidden="true" tabindex="-1"></a>Let's see some examples from the camtrapR vignettes. We're not going to download the package because the CRAN version of 'camtrapR' is not compatible with the CRAN version of 'taxize'.</span>
<span id="cb32-388"><a href="#cb32-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-389"><a href="#cb32-389" aria-hidden="true" tabindex="-1"></a>&lt;p align="center"&gt;</span>
<span id="cb32-390"><a href="#cb32-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-391"><a href="#cb32-391" aria-hidden="true" tabindex="-1"></a><span class="al">![](./images/facepalm.jpg)</span>{width="50%"}</span>
<span id="cb32-392"><a href="#cb32-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-393"><a href="#cb32-393" aria-hidden="true" tabindex="-1"></a>&lt;/p&gt;</span>
<span id="cb32-394"><a href="#cb32-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-395"><a href="#cb32-395" aria-hidden="true" tabindex="-1"></a>Let's rewrite the current function updating the arguments of 'taxize'.</span>
<span id="cb32-396"><a href="#cb32-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-399"><a href="#cb32-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-400"><a href="#cb32-400" aria-hidden="true" tabindex="-1"></a>checkSpeciesNames <span class="ot">&lt;-</span> <span class="cf">function</span> (speciesNames, searchtype, <span class="at">accepted =</span> <span class="cn">TRUE</span>, <span class="at">ask =</span> <span class="cn">TRUE</span>) </span>
<span id="cb32-401"><a href="#cb32-401" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb32-402"><a href="#cb32-402" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"taxize"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-403"><a href="#cb32-403" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Please install the package taxize to run this function"</span>)</span>
<span id="cb32-404"><a href="#cb32-404" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-405"><a href="#cb32-405" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"ritis"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb32-406"><a href="#cb32-406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"Please install the package ritis to run this function"</span>)</span>
<span id="cb32-407"><a href="#cb32-407" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-408"><a href="#cb32-408" aria-hidden="true" tabindex="-1"></a>  searchtype <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(searchtype, <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"scientific"</span>, </span>
<span id="cb32-409"><a href="#cb32-409" aria-hidden="true" tabindex="-1"></a>    <span class="st">"common"</span>))</span>
<span id="cb32-410"><a href="#cb32-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.logical</span>(accepted))</span>
<span id="cb32-411"><a href="#cb32-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(speciesNames) <span class="sc">|</span> <span class="fu">is.factor</span>(speciesNames))</span>
<span id="cb32-412"><a href="#cb32-412" aria-hidden="true" tabindex="-1"></a>  speciesNames <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">as.character</span>(speciesNames))</span>
<span id="cb32-413"><a href="#cb32-413" aria-hidden="true" tabindex="-1"></a>  file.sep <span class="ot">&lt;-</span> .Platform<span class="sc">$</span>file.sep</span>
<span id="cb32-414"><a href="#cb32-414" aria-hidden="true" tabindex="-1"></a>  tsns <span class="ot">&lt;-</span> <span class="fu">try</span>(taxize<span class="sc">::</span><span class="fu">get_tsn</span>(<span class="at">sci_com =</span> speciesNames, <span class="at">searchtype =</span> searchtype, </span>
<span id="cb32-415"><a href="#cb32-415" aria-hidden="true" tabindex="-1"></a>    <span class="at">accepted =</span> accepted, <span class="at">ask =</span> ask, <span class="at">messages =</span> <span class="cn">FALSE</span>))</span>
<span id="cb32-416"><a href="#cb32-416" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(tsns, <span class="st">"try-error"</span>)) {</span>
<span id="cb32-417"><a href="#cb32-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">paste</span>(<span class="st">"error in get_tsn. Exiting without results:</span><span class="sc">\n</span><span class="st">"</span>, </span>
<span id="cb32-418"><a href="#cb32-418" aria-hidden="true" tabindex="-1"></a>      tsns, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb32-419"><a href="#cb32-419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">invisible</span>(<span class="cn">NULL</span>))</span>
<span id="cb32-420"><a href="#cb32-420" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-421"><a href="#cb32-421" aria-hidden="true" tabindex="-1"></a>  tsns <span class="ot">&lt;-</span> taxize<span class="sc">::</span><span class="fu">as.tsn</span>(<span class="fu">unique</span>(tsns), <span class="at">check =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-422"><a href="#cb32-422" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(tsns))) {</span>
<span id="cb32-423"><a href="#cb32-423" aria-hidden="true" tabindex="-1"></a>    not.matched <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">is.na</span>(tsns))</span>
<span id="cb32-424"><a href="#cb32-424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">"found no matches for"</span>, <span class="fu">length</span>(not.matched), </span>
<span id="cb32-425"><a href="#cb32-425" aria-hidden="true" tabindex="-1"></a>      <span class="st">"name(s):</span><span class="sc">\n</span><span class="st">"</span>, <span class="fu">paste</span>(speciesNames[not.matched], <span class="at">collapse =</span> <span class="st">", "</span>)), </span>
<span id="cb32-426"><a href="#cb32-426" aria-hidden="true" tabindex="-1"></a>      <span class="at">immediate. =</span> <span class="cn">TRUE</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-427"><a href="#cb32-427" aria-hidden="true" tabindex="-1"></a>    tsns_worked <span class="ot">&lt;-</span> taxize<span class="sc">::</span><span class="fu">as.tsn</span>(tsns[<span class="sc">-</span>not.matched], <span class="at">check =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-428"><a href="#cb32-428" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb32-429"><a href="#cb32-429" aria-hidden="true" tabindex="-1"></a>    tsns_worked <span class="ot">&lt;-</span> tsns</span>
<span id="cb32-430"><a href="#cb32-430" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-431"><a href="#cb32-431" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-432"><a href="#cb32-432" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(tsns_worked) <span class="sc">&gt;=</span> <span class="dv">1</span>) {</span>
<span id="cb32-433"><a href="#cb32-433" aria-hidden="true" tabindex="-1"></a>    scientific <span class="ot">&lt;-</span> common <span class="ot">&lt;-</span> author <span class="ot">&lt;-</span> rankname <span class="ot">&lt;-</span> taxon_status <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb32-434"><a href="#cb32-434" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow =</span> <span class="fu">length</span>(tsns_worked), <span class="at">ncol =</span> <span class="dv">2</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-435"><a href="#cb32-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(scientific) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"combinedname"</span>)</span>
<span id="cb32-436"><a href="#cb32-436" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(common) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"commonName"</span>)</span>
<span id="cb32-437"><a href="#cb32-437" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(author) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"authorship"</span>)</span>
<span id="cb32-438"><a href="#cb32-438" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(rankname) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"rankname"</span>)</span>
<span id="cb32-439"><a href="#cb32-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(taxon_status) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"taxonUsageRating"</span>)</span>
<span id="cb32-440"><a href="#cb32-440" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-441"><a href="#cb32-441" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(tsns_worked)) {</span>
<span id="cb32-442"><a href="#cb32-442" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-443"><a href="#cb32-443" aria-hidden="true" tabindex="-1"></a>      scientific_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">scientific_name</span>(tsns_worked[i])</span>
<span id="cb32-444"><a href="#cb32-444" aria-hidden="true" tabindex="-1"></a>      common_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">common_names</span>(tsns_worked[i])</span>
<span id="cb32-445"><a href="#cb32-445" aria-hidden="true" tabindex="-1"></a>      author_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">taxon_authorship</span>(tsns_worked[i])</span>
<span id="cb32-446"><a href="#cb32-446" aria-hidden="true" tabindex="-1"></a>      rankname_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">rank_name</span>(tsns_worked[i])</span>
<span id="cb32-447"><a href="#cb32-447" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(scientific_tmp)) {</span>
<span id="cb32-448"><a href="#cb32-448" aria-hidden="true" tabindex="-1"></a>        scientific[i, ] <span class="ot">&lt;-</span> scientific_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"combinedname"</span>)]</span>
<span id="cb32-449"><a href="#cb32-449" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb32-450"><a href="#cb32-450" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(common_tmp)) {</span>
<span id="cb32-451"><a href="#cb32-451" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(common_tmp<span class="sc">$</span>tsn)) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb32-452"><a href="#cb32-452" aria-hidden="true" tabindex="-1"></a>          common2 <span class="ot">&lt;-</span> <span class="fu">tapply</span>(common_tmp<span class="sc">$</span>commonName, <span class="at">INDEX =</span> common_tmp<span class="sc">$</span>tsn, </span>
<span id="cb32-453"><a href="#cb32-453" aria-hidden="true" tabindex="-1"></a>            <span class="at">FUN =</span> paste, <span class="at">collapse =</span> file.sep)</span>
<span id="cb32-454"><a href="#cb32-454" aria-hidden="true" tabindex="-1"></a>          common_tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">commonName =</span> common2, </span>
<span id="cb32-455"><a href="#cb32-455" aria-hidden="true" tabindex="-1"></a>            <span class="at">tsn =</span> <span class="fu">rownames</span>(common2), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-456"><a href="#cb32-456" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb32-457"><a href="#cb32-457" aria-hidden="true" tabindex="-1"></a>        common[i, ] <span class="ot">&lt;-</span> common_tmp[, <span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"commonName"</span>)]</span>
<span id="cb32-458"><a href="#cb32-458" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb32-459"><a href="#cb32-459" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(author_tmp)) {</span>
<span id="cb32-460"><a href="#cb32-460" aria-hidden="true" tabindex="-1"></a>        author[i, ] <span class="ot">&lt;-</span> author_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"authorship"</span>)]</span>
<span id="cb32-461"><a href="#cb32-461" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb32-462"><a href="#cb32-462" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(rankname_tmp)) {</span>
<span id="cb32-463"><a href="#cb32-463" aria-hidden="true" tabindex="-1"></a>        rankname[i, ] <span class="ot">&lt;-</span> rankname_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, <span class="st">"rankname"</span>)]</span>
<span id="cb32-464"><a href="#cb32-464" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb32-465"><a href="#cb32-465" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (accepted <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb32-466"><a href="#cb32-466" aria-hidden="true" tabindex="-1"></a>        taxon_status_tmp <span class="ot">&lt;-</span> ritis<span class="sc">::</span><span class="fu">core_metadata</span>(tsns_worked[i])</span>
<span id="cb32-467"><a href="#cb32-467" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="st">"tsn"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(taxon_status_tmp)) {</span>
<span id="cb32-468"><a href="#cb32-468" aria-hidden="true" tabindex="-1"></a>          taxon_status[i, ] <span class="ot">&lt;-</span> taxon_status_tmp[<span class="fu">c</span>(<span class="st">"tsn"</span>, </span>
<span id="cb32-469"><a href="#cb32-469" aria-hidden="true" tabindex="-1"></a>            <span class="st">"taxonUsageRating"</span>)]</span>
<span id="cb32-470"><a href="#cb32-470" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb32-471"><a href="#cb32-471" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb32-472"><a href="#cb32-472" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-473"><a href="#cb32-473" aria-hidden="true" tabindex="-1"></a>    dat.out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">user_name =</span> speciesNames, <span class="at">tsn =</span> <span class="fu">as.numeric</span>(tsns))</span>
<span id="cb32-474"><a href="#cb32-474" aria-hidden="true" tabindex="-1"></a>    dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> scientific, <span class="at">by =</span> <span class="st">"tsn"</span>, </span>
<span id="cb32-475"><a href="#cb32-475" aria-hidden="true" tabindex="-1"></a>      <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-476"><a href="#cb32-476" aria-hidden="true" tabindex="-1"></a>    dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> common, <span class="at">by =</span> <span class="st">"tsn"</span>, </span>
<span id="cb32-477"><a href="#cb32-477" aria-hidden="true" tabindex="-1"></a>      <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-478"><a href="#cb32-478" aria-hidden="true" tabindex="-1"></a>    dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> author, <span class="at">by =</span> <span class="st">"tsn"</span>, </span>
<span id="cb32-479"><a href="#cb32-479" aria-hidden="true" tabindex="-1"></a>      <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-480"><a href="#cb32-480" aria-hidden="true" tabindex="-1"></a>    dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> rankname, <span class="at">by =</span> <span class="st">"tsn"</span>, </span>
<span id="cb32-481"><a href="#cb32-481" aria-hidden="true" tabindex="-1"></a>      <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-482"><a href="#cb32-482" aria-hidden="true" tabindex="-1"></a>    dat.out<span class="sc">$</span>itis_url <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb32-483"><a href="#cb32-483" aria-hidden="true" tabindex="-1"></a>    dat.out<span class="sc">$</span>itis_url[<span class="fu">match</span>(tsns_worked, dat.out<span class="sc">$</span>tsn)] <span class="ot">&lt;-</span> <span class="fu">attributes</span>(tsns_worked)<span class="sc">$</span>uri</span>
<span id="cb32-484"><a href="#cb32-484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(dat.out)[<span class="fu">colnames</span>(dat.out) <span class="sc">==</span> <span class="st">"combinedname"</span>] <span class="ot">&lt;-</span> <span class="st">"scientificName"</span></span>
<span id="cb32-485"><a href="#cb32-485" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (accepted <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb32-486"><a href="#cb32-486" aria-hidden="true" tabindex="-1"></a>      dat.out <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> dat.out, <span class="at">y =</span> taxon_status, </span>
<span id="cb32-487"><a href="#cb32-487" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">"tsn"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">sort =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-488"><a href="#cb32-488" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-489"><a href="#cb32-489" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb32-490"><a href="#cb32-490" aria-hidden="true" tabindex="-1"></a>      dat.out<span class="sc">$</span>taxon_status[<span class="sc">!</span><span class="fu">is.na</span>(dat.out<span class="sc">$</span>tsn)] <span class="ot">&lt;-</span> <span class="st">"valid"</span></span>
<span id="cb32-491"><a href="#cb32-491" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-492"><a href="#cb32-492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dat.out)</span>
<span id="cb32-493"><a href="#cb32-493" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb32-494"><a href="#cb32-494" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"found no TSNs for speciesNames"</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-495"><a href="#cb32-495" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-496"><a href="#cb32-496" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-497"><a href="#cb32-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-498"><a href="#cb32-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-499"><a href="#cb32-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-500"><a href="#cb32-500" aria-hidden="true" tabindex="-1"></a>Now, what can we do?</span>
<span id="cb32-501"><a href="#cb32-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-502"><a href="#cb32-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Search information by common names</span></span>
<span id="cb32-503"><a href="#cb32-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-506"><a href="#cb32-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-507"><a href="#cb32-507" aria-hidden="true" tabindex="-1"></a>checkNames1 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span>(<span class="at">speciesNames =</span> <span class="fu">c</span>(<span class="st">"Bearded Pig"</span>, <span class="st">"Malayan Civet"</span>),</span>
<span id="cb32-508"><a href="#cb32-508" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">searchtype   =</span> <span class="st">"common"</span>)</span>
<span id="cb32-509"><a href="#cb32-509" aria-hidden="true" tabindex="-1"></a>checkNames1<span class="sc">%&gt;%</span></span>
<span id="cb32-510"><a href="#cb32-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-511"><a href="#cb32-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_minimal</span>()</span>
<span id="cb32-512"><a href="#cb32-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-513"><a href="#cb32-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-514"><a href="#cb32-514" aria-hidden="true" tabindex="-1"></a><span class="fu">### Search information by scientific names (including subspecies)</span></span>
<span id="cb32-515"><a href="#cb32-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-518"><a href="#cb32-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-519"><a href="#cb32-519" aria-hidden="true" tabindex="-1"></a>checkNames2 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span> (<span class="at">speciesNames =</span> <span class="st">"Viverra tangalunga tangalunga"</span>,</span>
<span id="cb32-520"><a href="#cb32-520" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">searchtype   =</span> <span class="st">"scientific"</span>)</span>
<span id="cb32-521"><a href="#cb32-521" aria-hidden="true" tabindex="-1"></a>checkNames2<span class="sc">%&gt;%</span></span>
<span id="cb32-522"><a href="#cb32-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-523"><a href="#cb32-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_minimal</span>()</span>
<span id="cb32-524"><a href="#cb32-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-525"><a href="#cb32-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-526"><a href="#cb32-526" aria-hidden="true" tabindex="-1"></a><span class="fu">### Search information with an incorrect name</span></span>
<span id="cb32-527"><a href="#cb32-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-530"><a href="#cb32-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb32-531"><a href="#cb32-531" aria-hidden="true" tabindex="-1"></a>checkNames3 <span class="ot">&lt;-</span> <span class="fu">checkSpeciesNames</span> (<span class="at">speciesNames =</span> <span class="st">"Felis bengalensis"</span>,</span>
<span id="cb32-532"><a href="#cb32-532" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">searchtype   =</span> <span class="st">"scientific"</span>,</span>
<span id="cb32-533"><a href="#cb32-533" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">accepted     =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-534"><a href="#cb32-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-535"><a href="#cb32-535" aria-hidden="true" tabindex="-1"></a>checkNames3</span>
<span id="cb32-536"><a href="#cb32-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-537"><a href="#cb32-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-538"><a href="#cb32-538" aria-hidden="true" tabindex="-1"></a><span class="fu">### Search information with an ambiguous name</span></span>
<span id="cb32-539"><a href="#cb32-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-540"><a href="#cb32-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb32-541"><a href="#cb32-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-542"><a href="#cb32-542" aria-hidden="true" tabindex="-1"></a><span class="in">checkNames4 &lt;- checkSpeciesNames (speciesNames = "Chevrotain",</span></span>
<span id="cb32-543"><a href="#cb32-543" aria-hidden="true" tabindex="-1"></a><span class="in">                                  searchtype   = "common")</span></span>
<span id="cb32-544"><a href="#cb32-544" aria-hidden="true" tabindex="-1"></a><span class="in"># choose from the menu</span></span>
<span id="cb32-545"><a href="#cb32-545" aria-hidden="true" tabindex="-1"></a><span class="in">checkNames4 </span></span>
<span id="cb32-546"><a href="#cb32-546" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb32-547"><a href="#cb32-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb32-548"><a href="#cb32-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-549"><a href="#cb32-549" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb32-550"><a href="#cb32-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-551"><a href="#cb32-551" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered .unlisted}</span></span>
<span id="cb32-552"><a href="#cb32-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-553"><a href="#cb32-553" aria-hidden="true" tabindex="-1"></a>Chamberlain, S. A., &amp; Szöcs, E. (2013). taxize: taxonomic search and retrieval in R. F1000Research, 2.</span>
<span id="cb32-554"><a href="#cb32-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-555"><a href="#cb32-555" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb32-556"><a href="#cb32-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-557"><a href="#cb32-557" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Information {.unnumbered .unlisted}</span></span>
<span id="cb32-558"><a href="#cb32-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-559"><a href="#cb32-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb32-560"><a href="#cb32-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-561"><a href="#cb32-561" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb32-562"><a href="#cb32-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-563"><a href="#cb32-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div><font size="2"><font size="2"><font size="2">
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/marce10\.github\.io\/OTS_TBCP_2024\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</font></font></font></div><font size="2"><font size="2"><font size="2"> <!-- /content -->




</font></font></font></body></html>